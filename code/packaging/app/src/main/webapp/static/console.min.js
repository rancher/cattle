var NoVNC=function(e){var t,r={};Array.prototype.push8=function(e){this.push(255&e)},Array.prototype.push16=function(e){this.push(e>>8&255,255&e)},Array.prototype.push32=function(e){this.push(e>>24&255,e>>16&255,e>>8&255,255&e)},Array.prototype.map||(Array.prototype.map=function(e){var t=this.length;if("function"!=typeof e)throw new TypeError;for(var r=new Array(t),n=arguments[1],i=0;t>i;i++)i in this&&(r[i]=e.call(n,this[i],i,this));return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,r=Number(arguments[1])||0;for(r=0>r?Math.ceil(r):Math.floor(r),0>r&&(r+=t);t>r;r++)if(r in this&&this[r]===e)return r;return-1}),e.requestAnimFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)}}(),r._log_level="warn",r.init_logging=function(t){switch("undefined"==typeof t?t=r._log_level:r._log_level=t,"undefined"==typeof e.console&&(e.console="undefined"!=typeof e.opera?{log:e.opera.postError,warn:e.opera.postError,error:e.opera.postError}:{log:function(){},warn:function(){},error:function(){}}),r.Debug=r.Info=r.Warn=r.Error=function(){},t){case"debug":r.Debug=function(e){console.log(e)};case"info":r.Info=function(e){console.log(e)};case"warn":r.Warn=function(e){console.warn(e)};case"error":r.Error=function(e){console.error(e)};case"none":break;default:throw"invalid logging type '"+t+"'"}},r.get_logging=function(){return r._log_level},r.init_logging(),r.conf_default=function(e,t,r,n,i,o,s,a){var u,l;u=function(t){return o in{arr:1,array:1}&&"undefined"!=typeof t?e[n][t]:e[n]},l=function(t,r){o in{"boolean":1,bool:1}?t=!t||t in{0:1,no:1,"false":1}?!1:!0:o in{integer:1,"int":1}?t=parseInt(t,10):"str"===o?t=String(t):"func"===o&&(t||(t=function(){})),"undefined"!=typeof r?e[n][r]=t:e[n]=t},t[n+"_description"]=a,"undefined"==typeof t["get_"+n]&&(t["get_"+n]=u),"undefined"==typeof t["set_"+n]&&(t["set_"+n]=function(t,r){if(i in{RO:1,ro:1})throw n+" is read-only";if(i in{WO:1,wo:1}&&"undefined"!=typeof e[n])throw n+" can only be set once";l(t,r)}),"undefined"!=typeof r[n]?s=r[n]:o in{arr:1,array:1}&&!(s instanceof Array)&&(s=[]),l(s)},r.conf_defaults=function(e,t,n,i){var o;for(o=0;o<i.length;o++)r.conf_default(e,t,n,i[o][0],i[o][1],i[o][2],i[o][3],i[o][4])},r.decodeUTF8=function(e){return decodeURIComponent(escape(e))},r.get_include_uri=function(){return"undefined"!=typeof INCLUDE_URI?INCLUDE_URI:"include/"},r._loading_scripts=[],r._pending_scripts=[],r.load_scripts=function(t){for(var n,i=document.getElementsByTagName("head")[0],o=r._loading_scripts,s=r._pending_scripts,a=0;a<t.length;a++)n=document.createElement("script"),n.type="text/javascript",n.src=r.get_include_uri()+t[a],n.onload=n.onreadystatechange=function(){for(;o.length>0&&("loaded"===o[0].readyState||"complete"===o[0].readyState);){var t=o.shift();i.appendChild(t)}(!this.readyState||r.Engine.presto&&"loaded"===this.readyState||"complete"===this.readyState)&&s.indexOf(this)>=0&&(this.onload=this.onreadystatechange=null,s.splice(s.indexOf(this),1),0===s.length&&e.onscriptsload&&e.onscriptsload())},r.Engine.trident?o.push(n):(n.async=!1,i.appendChild(n)),s.push(n)},r.getPosition=function(){function t(t,r){if(t.currentStyle)var n=t.currentStyle[r];else if(e.getComputedStyle)var n=e.getComputedStyle(t,null)[r];return n}function r(){var e=0,t=0,r=document.getElementsByTagName("html")[0];return e=r.scrollTop&&document.documentElement.scrollTop?r.scrollTop:r.scrollTop||document.documentElement.scrollTop?r.scrollTop+document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0,t=r.scrollLeft&&document.documentElement.scrollLeft?r.scrollLeft:r.scrollLeft||document.documentElement.scrollLeft?r.scrollLeft+document.documentElement.scrollLeft:document.body.scrollLeft?document.body.scrollLeft:0,[t,e]}return function(n){for(var i=0,o=0,s=n,a=!1;(s=s.parentNode)&&s!=document.body;)i-=s.scrollLeft||0,o-=s.scrollTop||0,"fixed"==t(s,"position")&&(a=!0);if(a&&!e.opera){var u=r();i+=u[0],o+=u[1]}do i+=n.offsetLeft,o+=n.offsetTop;while(n=n.offsetParent);return{x:i,y:o}}}(),r.getEventPosition=function(t,n,i){var o,s,a,u;o=t?t:e.event,o=o.changedTouches?o.changedTouches[0]:o.touches?o.touches[0]:o,o.pageX||o.pageY?(s=o.pageX,a=o.pageY):(o.clientX||o.clientY)&&(s=o.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a=o.clientY+document.body.scrollTop+document.documentElement.scrollTop),u=r.getPosition(n),"undefined"==typeof i&&(i=1);var l=s-u.x,c=a-u.y,h=Math.max(Math.min(l,n.width-1),0),f=Math.max(Math.min(c,n.height-1),0);return{x:h/i,y:f/i,realx:l/i,realy:c/i}},r.addEvent=function(e,t,r){if(e.attachEvent){var n=e.attachEvent("on"+t,r);return n}if(e.addEventListener)return e.addEventListener(t,r,!1),!0;throw"Handler could not be attached"},r.removeEvent=function(e,t,r){if(e.detachEvent){var n=e.detachEvent("on"+t,r);return n}if(e.removeEventListener)return e.removeEventListener(t,r,!1),!0;throw"Handler could not be removed"},r.stopEvent=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1},r.Features={xpath:!!document.evaluate,air:!!e.runtime,query:!!document.querySelector},r.Engine={presto:function(){return e.opera?!0:!1}(),trident:function(){return e.ActiveXObject?e.XMLHttpRequest?document.querySelectorAll?6:5:4:!1}(),webkit:function(){try{return navigator.taintEnabled?!1:r.Features.xpath?r.Features.query?525:420:419}catch(e){return!1}}(),gecko:function(){return document.getBoxObjectFor||null!=e.mozInnerScreenX?document.getElementsByClassName?19:18:!1}()},r.Engine.webkit&&(r.Engine.webkit=function(e){var t=new RegExp("WebKit/([0-9.]*) ");return e=(navigator.userAgent.match(t)||["",e])[1],parseFloat(e,10)}(r.Engine.webkit)),r.Flash=function(){var e,t;try{e=navigator.plugins["Shockwave Flash"].description}catch(r){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(n){e="0 r0"}}return t=e.match(/\d+/g),{version:parseInt(t[0]||"0."+t[1],10)||0,build:parseInt(t[2],10)||0}}();var n={};e.$D||(e.$D=function(e){return document.getElementById?document.getElementById(e):document.all?document.all[e]:document.layers?document.layers[e]:void 0}),n.init_logging=function(e){r._log_level="undefined"!=typeof e?e:(document.location.href.match(/logging=([A-Za-z0-9\._\-]*)/)||["",r._log_level])[1],r.init_logging()},n.dirObj=function(e,t,r){var i,o="",s="";t||(t=2),r||(r="");for(i in e)t>1&&"object"==typeof e[i]?o+=n.dirObj(e[i],t-1,r+"."+i):(s="undefined"==typeof e[i]?"undefined":e[i].toString().replace("\n"," "),s.length>30&&(s=s.substr(0,30)+"..."),o+=r+"."+i+": "+s+"\n");return o},n.getQueryVar=function(e,t){var r=new RegExp(".*[?&]"+e+"=([^&#]*)"),n=document.location.href.match(r);return"undefined"==typeof t&&(t=null),n?decodeURIComponent(n[1]):t},n.createCookie=function(e,t,r){var n,i,o;r?(n=new Date,n.setTime(n.getTime()+24*r*60*60*1e3),i="; expires="+n.toGMTString()):i="",o="https:"===document.location.protocol?"; secure":"",document.cookie=e+"="+t+i+"; path=/"+o},n.readCookie=function(e,t){var r,n,i=e+"=",o=document.cookie.split(";");for(r=0;r<o.length;r+=1){for(n=o[r];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(i))return n.substring(i.length,n.length)}return"undefined"!=typeof t?t:null},n.eraseCookie=function(e){n.createCookie(e,"",-1)},n.initSettings=function(t){var r=Array.prototype.slice.call(arguments,1);e.chrome&&e.chrome.storage?e.chrome.storage.sync.get(function(e){n.settings=e,console.log(n.settings),t&&t.apply(this,r)}):t&&t.apply(this,r)},n.writeSetting=function(t,r){e.chrome&&e.chrome.storage?n.settings[t]!==r&&(n.settings[t]=r,e.chrome.storage.sync.set(n.settings)):localStorage.setItem(t,r)},n.readSetting=function(t,r){var i;return i=e.chrome&&e.chrome.storage?n.settings[t]:localStorage.getItem(t),"undefined"==typeof i&&(i=null),null===i&&void 0!==typeof r?r:i},n.eraseSetting=function(t){e.chrome&&e.chrome.storage?(e.chrome.storage.sync.remove(t),delete n.settings[t]):localStorage.removeItem(t)},n.getStylesheets=function(){var e,t,r=[];for(t=document.getElementsByTagName("link"),e=0;e<t.length;e+=1)t[e].title&&t[e].rel.toUpperCase().indexOf("STYLESHEET")>-1&&r.push(t[e]);return r},n.selectStylesheet=function(e){var t,i,o=n.getStylesheets();for("undefined"==typeof e&&(e="default"),t=0;t<o.length;t+=1)i=o[t],i.title===e?(r.Debug("Using stylesheet "+e),i.disabled=!1):i.disabled=!0;return e};var i={toBase64Table:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),base64Pad:"=",encode:function(e){"use strict";var t="",r=i.toBase64Table,n=e.length,o=n%3,s=0,a=0;for(s=0;n-2>s;s+=3)t+=r[e[s]>>2],t+=r[((3&e[s])<<4)+(e[s+1]>>4)],t+=r[((15&e[s+1])<<2)+(e[s+2]>>6)],t+=r[63&e[s+2]];return 2===o?(a=n-o,t+=r[e[a]>>2],t+=r[((3&e[a])<<4)+(e[a+1]>>4)],t+=r[(15&e[a+1])<<2],t+=r[64]):1===o&&(a=n-o,t+=r[e[a]>>2],t+=r[(3&e[a])<<4],t+=r[64],t+=r[64]),t},toBinaryTable:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],decode:function(e,t){"use strict";t="undefined"!=typeof t?t:0;var r,n,o,s,a,u,l=i.toBinaryTable,c=i.base64Pad,h=0,f=0,d=e.indexOf("=")-t;for(0>d&&(d=e.length-t),n=3*(d>>2)+Math.floor(d%4/1.5),r=new Array(n),o=0,s=t;s<e.length;s++)a=l[127&e.charCodeAt(s)],u=e.charAt(s)===c,-1!==a?(f=f<<6|a,h+=6,h>=8&&(h-=8,u||(r[o++]=f>>h&255),f&=(1<<h)-1)):console.error("Illegal character code "+e.charCodeAt(s)+" at position "+s);if(h)throw{name:"Base64-Error",message:"Corrupted base64 string"};return r}};e.WebSocket&&!e.WEB_SOCKET_FORCE_FLASH?t=!0:e.MozWebSocket&&!e.WEB_SOCKET_FORCE_FLASH?(t=!0,e.WebSocket=e.MozWebSocket):(t=!1,function(){e.WEB_SOCKET_SWF_LOCATION=r.get_include_uri()+"web-socket-js/WebSocketMain.swf",r.Engine.trident&&(r.Debug("Forcing uncached load of WebSocketMain.swf"),e.WEB_SOCKET_SWF_LOCATION+="?"+Math.random()),r.load_scripts(["web-socket-js/swfobject.js","web-socket-js/web_socket.js"])}());function o(){"use strict";var t={},n=null,o="base64",s=[],a=0,u=1e4,l=[],c={message:function(){},open:function(){},close:function(){},error:function(){}},h=!1;function f(){return l}function d(){return s}function p(){return a}function m(e){a=e}function b(){return s.length-a}function g(){return s[a]}function v(){return s[a++]}function y(e){0===a?s.unshift(e):(a-=1,s[a]=e)}function E(){return(s[a++]<<8)+s[a++]}function w(){return(s[a++]<<24)+(s[a++]<<16)+(s[a++]<<8)+s[a++]}function _(e){"undefined"==typeof e&&(e=b());var t=s.slice(a,a+e);return a+=e,String.fromCharCode.apply(null,t)}function C(e){return"undefined"==typeof e&&(e=b()),a+=e,s.slice(a-e,a)}function x(e,t){return t?s.slice(a+e,a+t):s.slice(a+e)}function T(e,t,r){var n=s.length-a;if(t>n){if(r){if(r>a)throw"rQwait cannot backup "+r+" bytes";a-=r}return!0}return!1}function k(){return"binary"===o?new Uint8Array(l).buffer:i.encode(l)}function O(e){if("binary"===o)for(var t=new Uint8Array(e),r=0;r<t.length;r++)s.push(t[r]);else s=s.concat(i.decode(e,0))}function A(){return 0!==n.bufferedAmount&&r.Debug("bufferedAmount: "+n.bufferedAmount),n.bufferedAmount<t.maxBufferedAmount?(l.length>0&&(n.send(k(l)),l=[]),!0):(r.Info("Delaying send, bufferedAmount: "+n.bufferedAmount),!1)}function S(e){return l=l.concat(e),A()}function D(e){t.send(e.split("").map(function(e){return e.charCodeAt(0)}))}function P(e){try{O(e.data),b()>0?(c.message(),s.length>u&&(s=s.slice(a),a=0)):r.Debug("Ignoring empty message")}catch(t){r.Warn("undefined"!=typeof t.stack?"recv_message, caught exception: "+t.stack:"undefined"!=typeof t.description?"recv_message, caught exception: "+t.description:"recv_message, caught exception:"+t),c.error("undefined"!=typeof t.name?t.name+": "+t.message:t)}}function I(e,t){c[e]=t}function N(t){s=[],a=0,l=[],n=null;var i=!1,o=!1;"Uint8Array"in e&&"set"in Uint8Array.prototype&&(i=!0);try{i&&"binaryType"in new WebSocket("ws://localhost:17523")&&(r.Info("Detected binaryType support in WebSockets"),o=!0)}catch(u){}if("undefined"==typeof t&&(t=o?["binary","base64"]:"base64"),!o){if("binary"===t)throw"WebSocket binary sub-protocol requested but not supported";if("object"==typeof t){for(var c=[],h=0;h<t.length;h++)"binary"===t[h]?r.Error("Skipping unsupported WebSocket binary sub-protocol"):c.push(t[h]);if(!(c.length>0))throw"Only WebSocket binary sub-protocol was requested and not supported.";t=c}}return t}function M(e,t){t=N(t),h?n={}:(n=new WebSocket(e,t),t.indexOf("binary")>=0&&(n.binaryType="arraybuffer")),n.onmessage=P,n.onopen=function(){r.Debug(">> WebSock.onopen"),n.protocol?(o=n.protocol,r.Info("Server chose sub-protocol: "+n.protocol)):(o="base64",r.Error("Server select no sub-protocol!: "+n.protocol)),c.open(),r.Debug("<< WebSock.onopen")},n.onclose=function(e){r.Debug(">> WebSock.onclose"),c.close(e),r.Debug("<< WebSock.onclose")},n.onerror=function(e){r.Debug(">> WebSock.onerror: "+e),c.error(e),r.Debug("<< WebSock.onerror")}}function R(){n&&((n.readyState===WebSocket.OPEN||n.readyState===WebSocket.CONNECTING)&&(r.Info("Closing WebSocket connection"),n.close()),n.onmessage=function(){})}function j(e,r){return h=!0,o=r,t.send=e,t.close=function(){},P}function V(){return t.maxBufferedAmount=200,t.get_sQ=f,t.get_rQ=d,t.get_rQi=p,t.set_rQi=m,t.rQlen=b,t.rQpeek8=g,t.rQshift8=v,t.rQunshift8=y,t.rQshift16=E,t.rQshift32=w,t.rQshiftStr=_,t.rQshiftBytes=C,t.rQslice=x,t.rQwait=T,t.flush=A,t.send=S,t.send_string=D,t.on=I,t.init=N,t.open=M,t.close=R,t.testMode=j,t}return V()}function s(e){var t,r,n,i,o,s,a,u,l,c,h,f,d,p,m=[13,16,10,23,0,4,2,27,14,5,20,9,22,18,11,3,25,7,15,6,26,19,12,1,40,51,30,36,46,54,29,39,50,44,32,47,43,48,38,55,33,52,45,41,49,35,28,31],b=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],g=0,v=[];t=65536,r=1<<24,n=t|r,i=4,o=1024,s=i|o,a=[n|o,g|g,t|g,n|s,n|i,t|s,g|i,t|g,g|o,n|o,n|s,g|o,r|s,n|i,r|g,g|i,g|s,r|o,r|o,t|o,t|o,n|g,n|g,r|s,t|i,r|i,r|i,t|i,g|g,g|s,t|s,r|g,t|g,n|s,g|i,n|g,n|o,r|g,r|g,g|o,n|i,t|g,t|o,r|i,g|o,g|i,r|s,t|s,n|s,t|i,n|g,r|s,r|i,g|s,t|s,n|o,g|s,r|o,r|o,g|g,t|i,t|o,g|g,n|i],t=1<<20,r=1<<31,n=t|r,i=32,o=32768,s=i|o,u=[n|s,r|o,g|o,t|s,t|g,g|i,n|i,r|s,r|i,n|s,n|o,r|g,r|o,t|g,g|i,n|i,t|o,t|i,r|s,g|g,r|g,g|o,t|s,n|g,t|i,r|i,g|g,t|o,g|s,n|o,n|g,g|s,g|g,t|s,n|i,t|g,r|s,n|g,n|o,g|o,n|g,r|o,g|i,n|s,t|s,g|i,g|o,r|g,g|s,n|o,t|g,r|i,t|i,r|s,r|i,t|i,t|o,g|g,r|o,g|s,r|g,n|i,n|s,t|o],t=1<<17,r=1<<27,n=t|r,i=8,o=512,s=i|o,l=[g|s,n|o,g|g,n|i,r|o,g|g,t|s,r|o,t|i,r|i,r|i,t|g,n|s,t|i,n|g,g|s,r|g,g|i,n|o,g|o,t|o,n|g,n|i,t|s,r|s,t|o,t|g,r|s,g|i,n|s,g|o,r|g,n|o,r|g,t|i,g|s,t|g,n|o,r|o,g|g,g|o,t|i,n|s,r|o,r|i,g|o,g|g,n|i,r|s,t|g,r|g,n|s,g|i,t|s,t|o,r|i,n|g,r|s,g|s,n|g,t|s,g|i,n|i,t|o],t=8192,r=1<<23,n=t|r,i=1,o=128,s=i|o,c=[n|i,t|s,t|s,g|o,n|o,r|s,r|i,t|i,g|g,n|g,n|g,n|s,g|s,g|g,r|o,r|i,g|i,t|g,r|g,n|i,g|o,r|g,t|i,t|o,r|s,g|i,t|o,r|o,t|g,n|o,n|s,g|s,r|o,r|i,n|g,n|s,g|s,g|g,g|g,n|g,t|o,r|o,r|s,g|i,n|i,t|s,t|s,g|o,n|s,g|s,g|i,t|g,r|i,t|i,n|o,r|s,t|i,t|o,r|g,n|i,g|o,r|g,t|g,n|o],t=1<<25,r=1<<30,n=t|r,i=256,o=1<<19,s=i|o,h=[g|i,t|s,t|o,n|i,g|o,g|i,r|g,t|o,r|s,g|o,t|i,r|s,n|i,n|o,g|s,r|g,t|g,r|o,r|o,g|g,r|i,n|s,n|s,t|i,n|o,r|i,g|g,n|g,t|s,t|g,n|g,g|s,g|o,n|i,g|i,t|g,r|g,t|o,n|i,r|s,t|i,r|g,n|o,t|s,r|s,g|i,t|g,n|o,n|s,g|s,n|g,n|s,t|o,g|g,r|o,n|g,g|s,t|i,r|i,g|o,g|g,r|o,t|s,r|i],t=1<<22,r=1<<29,n=t|r,i=16,o=16384,s=i|o,f=[r|i,n|g,g|o,n|s,n|g,g|i,n|s,t|g,r|o,t|s,t|g,r|i,t|i,r|o,r|g,g|s,g|g,t|i,r|s,g|o,t|o,r|s,g|i,n|i,n|i,g|g,t|s,n|o,g|s,t|o,n|o,r|g,r|o,g|i,n|i,t|o,n|s,t|g,g|s,r|i,t|g,r|o,r|g,g|s,r|i,n|s,t|o,n|g,t|s,n|o,g|g,n|i,g|i,g|o,n|g,t|s,g|o,t|i,r|s,g|g,n|o,r|g,t|i,r|s],t=1<<21,r=1<<26,n=t|r,i=2,o=2048,s=i|o,d=[t|g,n|i,r|s,g|g,g|o,r|s,t|s,n|o,n|s,t|g,g|g,r|i,g|i,r|g,n|i,g|s,r|o,t|s,t|i,r|o,r|i,n|g,n|o,t|i,n|g,g|o,g|s,n|s,t|o,g|i,r|g,t|o,r|g,t|o,t|g,r|s,r|s,n|i,n|i,g|i,t|i,r|g,r|o,t|g,n|o,g|s,t|s,n|o,g|s,r|i,n|s,n|g,t|o,g|g,g|i,n|s,g|g,t|s,n|g,g|o,r|i,r|o,g|o,t|i],t=1<<18,r=1<<28,n=t|r,i=64,o=4096,s=i|o,p=[r|s,g|o,t|g,n|s,r|g,r|s,g|i,r|g,t|i,n|g,n|s,t|o,n|o,t|s,g|o,g|i,n|g,r|i,r|o,g|s,t|o,t|i,n|i,n|o,g|s,g|g,g|g,n|i,r|i,r|o,t|s,t|g,t|s,t|g,n|o,g|o,g|i,n|i,g|o,t|s,r|o,g|i,r|i,n|g,n|i,r|g,t|g,r|s,g|g,n|s,t|i,r|i,n|g,r|o,r|s,g|g,n|s,t|o,t|o,g|s,g|s,t|i,r|g,n|o];function y(e){var t,r,n,i,o,s,a,u,l,c,h=[],f=[],d=[];for(r=0,n=56;56>r;++r,n-=8)n+=-5>n?65:-3>n?31:-1>n?63:27===n?35:0,i=7&n,h[r]=0!==(e[n>>>3]&1<<i)?1:0;for(t=0;16>t;++t){for(i=t<<1,o=i+1,d[i]=d[o]=0,s=28;59>s;s+=28)for(r=s-28;s>r;++r)n=r+b[t],f[r]=s>n?h[n]:h[n-28];for(r=0;24>r;++r)0!==f[m[r]]&&(d[i]|=1<<23-r),0!==f[m[r+24]]&&(d[o]|=1<<23-r)}for(t=0,l=0,c=0;16>t;++t)a=d[l++],u=d[l++],v[c]=(16515072&a)<<6,v[c]|=(4032&a)<<10,v[c]|=(16515072&u)>>>10,v[c]|=(4032&u)>>>6,++c,v[c]=(258048&a)<<12,v[c]|=(63&a)<<16,v[c]|=(258048&u)>>>4,v[c]|=63&u,++c}function E(e){var t,r,n,i,o=0,s=e.slice(),m=0;for(r=s[o++]<<24|s[o++]<<16|s[o++]<<8|s[o++],n=s[o++]<<24|s[o++]<<16|s[o++]<<8|s[o++],i=252645135&(r>>>4^n),n^=i,r^=i<<4,i=65535&(r>>>16^n),n^=i,r^=i<<16,i=858993459&(n>>>2^r),r^=i,n^=i<<2,i=16711935&(n>>>8^r),r^=i,n^=i<<8,n=n<<1|n>>>31&1,i=2863311530&(r^n),r^=i,n^=i,r=r<<1|r>>>31&1,o=0;8>o;++o)i=n<<28|n>>>4,i^=v[m++],t=d[63&i],t|=h[i>>>8&63],t|=l[i>>>16&63],t|=a[i>>>24&63],i=n^v[m++],t|=p[63&i],t|=f[i>>>8&63],t|=c[i>>>16&63],t|=u[i>>>24&63],r^=t,i=r<<28|r>>>4,i^=v[m++],t=d[63&i],t|=h[i>>>8&63],t|=l[i>>>16&63],t|=a[i>>>24&63],i=r^v[m++],t|=p[63&i],t|=f[i>>>8&63],t|=c[i>>>16&63],t|=u[i>>>24&63],n^=t;for(n=n<<31|n>>>1,i=2863311530&(r^n),r^=i,n^=i,r=r<<31|r>>>1,i=16711935&(r>>>8^n),n^=i,r^=i<<8,i=858993459&(r>>>2^n),n^=i,r^=i<<2,i=65535&(n>>>16^r),r^=i,n^=i<<16,i=252645135&(n>>>4^r),r^=i,n^=i<<4,i=[n,r],o=0;8>o;o++)s[o]=(i[o>>>2]>>>8*(3-o%4))%256,s[o]<0&&(s[o]+=256);return s}function w(e){return E(e.slice(0,8)).concat(E(e.slice(8,16)))}return y(e),{encrypt:w}}var a=function(){"use strict";var e=null,t={32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,61:61,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90,91:91,92:92,93:93,94:94,95:95,96:96,97:97,98:98,99:99,100:100,101:101,102:102,103:103,104:104,105:105,106:106,107:107,108:108,109:109,110:110,111:111,112:112,113:113,114:114,115:115,116:116,117:117,118:118,119:119,120:120,121:121,122:122,123:123,124:124,125:125,126:126,160:160,161:161,162:162,163:163,164:164,165:165,166:166,167:167,168:168,169:169,170:170,171:171,172:172,173:173,174:174,175:175,176:176,177:177,178:178,179:179,180:180,181:181,182:182,183:183,184:184,185:185,186:186,187:187,188:188,189:189,190:190,191:191,192:192,193:193,194:194,195:195,196:196,197:197,198:198,199:199,200:200,201:201,202:202,203:203,204:204,205:205,206:206,207:207,208:208,209:209,210:210,211:211,212:212,213:213,214:214,215:215,216:216,217:217,218:218,219:219,220:220,221:221,222:222,223:223,224:224,225:225,226:226,227:227,228:228,229:229,230:230,231:231,232:232,233:233,234:234,235:235,236:236,237:237,238:238,239:239,240:240,241:241,242:242,243:243,244:244,245:245,246:246,247:247,248:248,249:249,250:250,251:251,252:252,253:253,254:254,255:255,256:960,257:992,258:451,259:483,260:417,261:433,262:454,263:486,264:710,265:742,266:709,267:741,268:456,269:488,270:463,271:495,272:464,273:496,274:938,275:954,278:972,279:1004,280:458,281:490,282:460,283:492,284:728,285:760,286:683,287:699,288:725,289:757,290:939,291:955,292:678,293:694,294:673,295:689,296:933,297:949,298:975,299:1007,300:16777516,301:16777517,302:967,303:999,304:681,305:697,308:684,309:700,310:979,311:1011,312:930,313:453,314:485,315:934,316:950,317:421,318:437,321:419,322:435,323:465,324:497,325:977,326:1009,327:466,328:498,330:957,331:959,332:978,333:1010,336:469,337:501,338:5052,339:5053,340:448,341:480,342:931,343:947,344:472,345:504,346:422,347:438,348:734,349:766,350:426,351:442,352:425,353:441,354:478,355:510,356:427,357:443,358:940,359:956,360:989,361:1021,362:990,363:1022,364:733,365:765,366:473,367:505,368:475,369:507,370:985,371:1017,372:16777588,373:16777589,374:16777590,375:16777591,376:5054,377:428,378:444,379:431,380:447,381:430,382:446,399:16777615,402:2294,415:16777631,416:16777632,417:16777633,431:16777647,432:16777648,437:16777653,438:16777654,439:16777655,466:16777681,486:16777702,487:16777703,601:16777817,629:16777845,658:16777874,711:439,728:418,729:511,731:434,733:445,901:1966,902:1953,904:1954,905:1955,906:1956,908:1959,910:1960,911:1963,912:1974,913:1985,914:1986,915:1987,916:1988,917:1989,918:1990,919:1991,920:1992,921:1993,922:1994,923:1995,924:1996,925:1997,926:1998,927:1999,928:2e3,929:2001,931:2002,932:2004,933:2005,934:2006,935:2007,936:2008,937:2009,938:1957,939:1961,940:1969,941:1970,942:1971,943:1972,944:1978,945:2017,946:2018,947:2019,948:2020,949:2021,950:2022,951:2023,952:2024,953:2025,954:2026,955:2027,956:2028,957:2029,958:2030,959:2031,960:2032,961:2033,962:2035,963:2034,964:2036,965:2037,966:2038,967:2039,968:2040,969:2041,970:1973,971:1977,972:1975,973:1976,974:1979,1025:1715,1026:1713,1027:1714,1028:1716,1029:1717,1030:1718,1031:1719,1032:1720,1033:1721,1034:1722,1035:1723,1036:1724,1038:1726,1039:1727,1040:1761,1041:1762,1042:1783,1043:1767,1044:1764,1045:1765,1046:1782,1047:1786,1048:1769,1049:1770,1050:1771,1051:1772,1052:1773,1053:1774,1054:1775,1055:1776,1056:1778,1057:1779,1058:1780,1059:1781,1060:1766,1061:1768,1062:1763,1063:1790,1064:1787,1065:1789,1066:1791,1067:1785,1068:1784,1069:1788,1070:1760,1071:1777,1072:1729,1073:1730,1074:1751,1075:1735,1076:1732,1077:1733,1078:1750,1079:1754,1080:1737,1081:1738,1082:1739,1083:1740,1084:1741,1085:1742,1086:1743,1087:1744,1088:1746,1089:1747,1090:1748,1091:1749,1092:1734,1093:1736,1094:1731,1095:1758,1096:1755,1097:1757,1098:1759,1099:1753,1100:1752,1101:1756,1102:1728,1103:1745,1105:1699,1106:1697,1107:1698,1108:1700,1109:1701,1110:1702,1111:1703,1112:1704,1113:1705,1114:1706,1115:1707,1116:1708,1118:1710,1119:1711,1168:1725,1169:1709,1170:16778386,1171:16778387,1174:16778390,1175:16778391,1178:16778394,1179:16778395,1180:16778396,1181:16778397,1186:16778402,1187:16778403,1198:16778414,1199:16778415,1200:16778416,1201:16778417,1202:16778418,1203:16778419,1206:16778422,1207:16778423,1208:16778424,1209:16778425,1210:16778426,1211:16778427,1240:16778456,1241:16778457,1250:16778466,1251:16778467,1256:16778472,1257:16778473,1262:16778478,1263:16778479,1329:16778545,1330:16778546,1331:16778547,1332:16778548,1333:16778549,1334:16778550,1335:16778551,1336:16778552,1337:16778553,1338:16778554,1339:16778555,1340:16778556,1341:16778557,1342:16778558,1343:16778559,1344:16778560,1345:16778561,1346:16778562,1347:16778563,1348:16778564,1349:16778565,1350:16778566,1351:16778567,1352:16778568,1353:16778569,1354:16778570,1355:16778571,1356:16778572,1357:16778573,1358:16778574,1359:16778575,1360:16778576,1361:16778577,1362:16778578,1363:16778579,1364:16778580,1365:16778581,1366:16778582,1370:16778586,1371:16778587,1372:16778588,1373:16778589,1374:16778590,1377:16778593,1378:16778594,1379:16778595,1380:16778596,1381:16778597,1382:16778598,1383:16778599,1384:16778600,1385:16778601,1386:16778602,1387:16778603,1388:16778604,1389:16778605,1390:16778606,1391:16778607,1392:16778608,1393:16778609,1394:16778610,1395:16778611,1396:16778612,1397:16778613,1398:16778614,1399:16778615,1400:16778616,1401:16778617,1402:16778618,1403:16778619,1404:16778620,1405:16778621,1406:16778622,1407:16778623,1408:16778624,1409:16778625,1410:16778626,1411:16778627,1412:16778628,1413:16778629,1414:16778630,1415:16778631,1417:16778633,1418:16778634,1488:3296,1489:3297,1490:3298,1491:3299,1492:3300,1493:3301,1494:3302,1495:3303,1496:3304,1497:3305,1498:3306,1499:3307,1500:3308,1501:3309,1502:3310,1503:3311,1504:3312,1505:3313,1506:3314,1507:3315,1508:3316,1509:3317,1510:3318,1511:3319,1512:3320,1513:3321,1514:3322,1548:1452,1563:1467,1567:1471,1569:1473,1570:1474,1571:1475,1572:1476,1573:1477,1574:1478,1575:1479,1576:1480,1577:1481,1578:1482,1579:1483,1580:1484,1581:1485,1582:1486,1583:1487,1584:1488,1585:1489,1586:1490,1587:1491,1588:1492,1589:1493,1590:1494,1591:1495,1592:1496,1593:1497,1594:1498,1600:1504,1601:1505,1602:1506,1603:1507,1604:1508,1605:1509,1606:1510,1607:1511,1608:1512,1609:1513,1610:1514,1611:1515,1612:1516,1613:1517,1614:1518,1615:1519,1616:1520,1617:1521,1618:1522,1619:16778835,1620:16778836,1621:16778837,1632:16778848,1633:16778849,1634:16778850,1635:16778851,1636:16778852,1637:16778853,1638:16778854,1639:16778855,1640:16778856,1641:16778857,1642:16778858,1648:16778864,1657:16778873,1662:16778878,1670:16778886,1672:16778888,1681:16778897,1688:16778904,1700:16778916,1705:16778921,1711:16778927,1722:16778938,1726:16778942,1729:16778945,1740:16778956,1746:16778962,1748:16778964,1776:16778992,1777:16778993,1778:16778994,1779:16778995,1780:16778996,1781:16778997,1782:16778998,1783:16778999,1784:16779e3,1785:16779001,3458:16780674,3459:16780675,3461:16780677,3462:16780678,3463:16780679,3464:16780680,3465:16780681,3466:16780682,3467:16780683,3468:16780684,3469:16780685,3470:16780686,3471:16780687,3472:16780688,3473:16780689,3474:16780690,3475:16780691,3476:16780692,3477:16780693,3478:16780694,3482:16780698,3483:16780699,3484:16780700,3485:16780701,3486:16780702,3487:16780703,3488:16780704,3489:16780705,3490:16780706,3491:16780707,3492:16780708,3493:16780709,3494:16780710,3495:16780711,3496:16780712,3497:16780713,3498:16780714,3499:16780715,3500:16780716,3501:16780717,3502:16780718,3503:16780719,3504:16780720,3505:16780721,3507:16780723,3508:16780724,3509:16780725,3510:16780726,3511:16780727,3512:16780728,3513:16780729,3514:16780730,3515:16780731,3517:16780733,3520:16780736,3521:16780737,3522:16780738,3523:16780739,3524:16780740,3525:16780741,3526:16780742,3530:16780746,3535:16780751,3536:16780752,3537:16780753,3538:16780754,3539:16780755,3540:16780756,3542:16780758,3544:16780760,3545:16780761,3546:16780762,3547:16780763,3548:16780764,3549:16780765,3550:16780766,3551:16780767,3570:16780786,3571:16780787,3572:16780788,3585:3489,3586:3490,3587:3491,3588:3492,3589:3493,3590:3494,3591:3495,3592:3496,3593:3497,3594:3498,3595:3499,3596:3500,3597:3501,3598:3502,3599:3503,3600:3504,3601:3505,3602:3506,3603:3507,3604:3508,3605:3509,3606:3510,3607:3511,3608:3512,3609:3513,3610:3514,3611:3515,3612:3516,3613:3517,3614:3518,3615:3519,3616:3520,3617:3521,3618:3522,3619:3523,3620:3524,3621:3525,3622:3526,3623:3527,3624:3528,3625:3529,3626:3530,3627:3531,3628:3532,3629:3533,3630:3534,3631:3535,3632:3536,3633:3537,3634:3538,3635:3539,3636:3540,3637:3541,3638:3542,3639:3543,3640:3544,3641:3545,3642:3546,3647:3551,3648:3552,3649:3553,3650:3554,3651:3555,3652:3556,3653:3557,3654:3558,3655:3559,3656:3560,3657:3561,3658:3562,3659:3563,3660:3564,3661:3565,3664:3568,3665:3569,3666:3570,3667:3571,3668:3572,3669:3573,3670:3574,3671:3575,3672:3576,3673:3577,4304:16781520,4305:16781521,4306:16781522,4307:16781523,4308:16781524,4309:16781525,4310:16781526,4311:16781527,4312:16781528,4313:16781529,4314:16781530,4315:16781531,4316:16781532,4317:16781533,4318:16781534,4319:16781535,4320:16781536,4321:16781537,4322:16781538,4323:16781539,4324:16781540,4325:16781541,4326:16781542,4327:16781543,4328:16781544,4329:16781545,4330:16781546,4331:16781547,4332:16781548,4333:16781549,4334:16781550,4335:16781551,4336:16781552,4337:16781553,4338:16781554,4339:16781555,4340:16781556,4341:16781557,4342:16781558,7682:16784898,7683:16784899,7690:16784906,7691:16784907,7710:16784926,7711:16784927,7734:16784950,7735:16784951,7744:16784960,7745:16784961,7766:16784982,7767:16784983,7776:16784992,7777:16784993,7786:16785002,7787:16785003,7808:16785024,7809:16785025,7810:16785026,7811:16785027,7812:16785028,7813:16785029,7818:16785034,7819:16785035,7840:16785056,7841:16785057,7842:16785058,7843:16785059,7844:16785060,7845:16785061,7846:16785062,7847:16785063,7848:16785064,7849:16785065,7850:16785066,7851:16785067,7852:16785068,7853:16785069,7854:16785070,7855:16785071,7856:16785072,7857:16785073,7858:16785074,7859:16785075,7860:16785076,7861:16785077,7862:16785078,7863:16785079,7864:16785080,7865:16785081,7866:16785082,7867:16785083,7868:16785084,7869:16785085,7870:16785086,7871:16785087,7872:16785088,7873:16785089,7874:16785090,7875:16785091,7876:16785092,7877:16785093,7878:16785094,7879:16785095,7880:16785096,7881:16785097,7882:16785098,7883:16785099,7884:16785100,7885:16785101,7886:16785102,7887:16785103,7888:16785104,7889:16785105,7890:16785106,7891:16785107,7892:16785108,7893:16785109,7894:16785110,7895:16785111,7896:16785112,7897:16785113,7898:16785114,7899:16785115,7900:16785116,7901:16785117,7902:16785118,7903:16785119,7904:16785120,7905:16785121,7906:16785122,7907:16785123,7908:16785124,7909:16785125,7910:16785126,7911:16785127,7912:16785128,7913:16785129,7914:16785130,7915:16785131,7916:16785132,7917:16785133,7918:16785134,7919:16785135,7920:16785136,7921:16785137,7922:16785138,7923:16785139,7924:16785140,7925:16785141,7926:16785142,7927:16785143,7928:16785144,7929:16785145,8194:2722,8195:2721,8196:2723,8197:2724,8199:2725,8200:2726,8201:2727,8202:2728,8210:2747,8211:2730,8212:2729,8213:1967,8215:3295,8216:2768,8217:2769,8218:2813,8220:2770,8221:2771,8222:2814,8224:2801,8225:2802,8226:2790,8229:2735,8230:2734,8240:2773,8242:2774,8243:2775,8248:2812,8254:1150,8304:16785520,8308:16785524,8309:16785525,8310:16785526,8311:16785527,8312:16785528,8313:16785529,8320:16785536,8321:16785537,8322:16785538,8323:16785539,8324:16785540,8325:16785541,8326:16785542,8327:16785543,8328:16785544,8329:16785545,8352:16785568,8353:16785569,8354:16785570,8355:16785571,8356:16785572,8357:16785573,8358:16785574,8359:16785575,8360:16785576,8361:3839,8362:16785578,8363:16785579,8364:8364,8453:2744,8470:1712,8471:2811,8478:2772,8482:2761,8531:2736,8532:2737,8533:2738,8534:2739,8535:2740,8536:2741,8537:2742,8538:2743,8539:2755,8540:2756,8541:2757,8542:2758,8592:2299,8593:2300,8594:2301,8595:2302,8658:2254,8660:2253,8706:2287,8709:16785925,8711:2245,8712:16785928,8713:16785929,8715:16785931,8728:3018,8730:2262,8731:16785947,8732:16785948,8733:2241,8734:2242,8743:2270,8744:2271,8745:2268,8746:2269,8747:2239,8748:16785964,8749:16785965,8756:2240,8757:16785973,8764:2248,8771:2249,8773:16785992,8775:16785991,8800:2237,8801:2255,8802:16786018,8803:16786019,8804:2236,8805:2238,8834:2266,8835:2267,8866:3068,8867:3036,8868:3010,8869:3022,8968:3027,8970:3012,8981:2810,8992:2212,8993:2213,9109:3020,9115:2219,9117:2220,9118:2221,9120:2222,9121:2215,9123:2216,9124:2217,9126:2218,9128:2223,9132:2224,9143:2209,9146:2543,9147:2544,9148:2546,9149:2547,9225:2530,9226:2533,9227:2537,9228:2531,9229:2532,9251:2732,9252:2536,9472:2211,9474:2214,9484:2210,9488:2539,9492:2541,9496:2538,9500:2548,9508:2549,9516:2551,9524:2550,9532:2542,9618:2529,9642:2791,9643:2785,9644:2779,9645:2786,9646:2783,9647:2767,9650:2792,9651:2787,9654:2781,9655:2765,9660:2793,9661:2788,9664:2780,9665:2764,9670:2528,9675:2766,9679:2782,9702:2784,9734:2789,9742:2809,9747:2762,9756:2794,9758:2795,9792:2808,9794:2807,9827:2796,9829:2798,9830:2797,9837:2806,9839:2805,10003:2803,10007:2804,10013:2777,10016:2800,10216:2748,10217:2750,10240:16787456,10241:16787457,10242:16787458,10243:16787459,10244:16787460,10245:16787461,10246:16787462,10247:16787463,10248:16787464,10249:16787465,10250:16787466,10251:16787467,10252:16787468,10253:16787469,10254:16787470,10255:16787471,10256:16787472,10257:16787473,10258:16787474,10259:16787475,10260:16787476,10261:16787477,10262:16787478,10263:16787479,10264:16787480,10265:16787481,10266:16787482,10267:16787483,10268:16787484,10269:16787485,10270:16787486,10271:16787487,10272:16787488,10273:16787489,10274:16787490,10275:16787491,10276:16787492,10277:16787493,10278:16787494,10279:16787495,10280:16787496,10281:16787497,10282:16787498,10283:16787499,10284:16787500,10285:16787501,10286:16787502,10287:16787503,10288:16787504,10289:16787505,10290:16787506,10291:16787507,10292:16787508,10293:16787509,10294:16787510,10295:16787511,10296:16787512,10297:16787513,10298:16787514,10299:16787515,10300:16787516,10301:16787517,10302:16787518,10303:16787519,10304:16787520,10305:16787521,10306:16787522,10307:16787523,10308:16787524,10309:16787525,10310:16787526,10311:16787527,10312:16787528,10313:16787529,10314:16787530,10315:16787531,10316:16787532,10317:16787533,10318:16787534,10319:16787535,10320:16787536,10321:16787537,10322:16787538,10323:16787539,10324:16787540,10325:16787541,10326:16787542,10327:16787543,10328:16787544,10329:16787545,10330:16787546,10331:16787547,10332:16787548,10333:16787549,10334:16787550,10335:16787551,10336:16787552,10337:16787553,10338:16787554,10339:16787555,10340:16787556,10341:16787557,10342:16787558,10343:16787559,10344:16787560,10345:16787561,10346:16787562,10347:16787563,10348:16787564,10349:16787565,10350:16787566,10351:16787567,10352:16787568,10353:16787569,10354:16787570,10355:16787571,10356:16787572,10357:16787573,10358:16787574,10359:16787575,10360:16787576,10361:16787577,10362:16787578,10363:16787579,10364:16787580,10365:16787581,10366:16787582,10367:16787583,10368:16787584,10369:16787585,10370:16787586,10371:16787587,10372:16787588,10373:16787589,10374:16787590,10375:16787591,10376:16787592,10377:16787593,10378:16787594,10379:16787595,10380:16787596,10381:16787597,10382:16787598,10383:16787599,10384:16787600,10385:16787601,10386:16787602,10387:16787603,10388:16787604,10389:16787605,10390:16787606,10391:16787607,10392:16787608,10393:16787609,10394:16787610,10395:16787611,10396:16787612,10397:16787613,10398:16787614,10399:16787615,10400:16787616,10401:16787617,10402:16787618,10403:16787619,10404:16787620,10405:16787621,10406:16787622,10407:16787623,10408:16787624,10409:16787625,10410:16787626,10411:16787627,10412:16787628,10413:16787629,10414:16787630,10415:16787631,10416:16787632,10417:16787633,10418:16787634,10419:16787635,10420:16787636,10421:16787637,10422:16787638,10423:16787639,10424:16787640,10425:16787641,10426:16787642,10427:16787643,10428:16787644,10429:16787645,10430:16787646,10431:16787647,10432:16787648,10433:16787649,10434:16787650,10435:16787651,10436:16787652,10437:16787653,10438:16787654,10439:16787655,10440:16787656,10441:16787657,10442:16787658,10443:16787659,10444:16787660,10445:16787661,10446:16787662,10447:16787663,10448:16787664,10449:16787665,10450:16787666,10451:16787667,10452:16787668,10453:16787669,10454:16787670,10455:16787671,10456:16787672,10457:16787673,10458:16787674,10459:16787675,10460:16787676,10461:16787677,10462:16787678,10463:16787679,10464:16787680,10465:16787681,10466:16787682,10467:16787683,10468:16787684,10469:16787685,10470:16787686,10471:16787687,10472:16787688,10473:16787689,10474:16787690,10475:16787691,10476:16787692,10477:16787693,10478:16787694,10479:16787695,10480:16787696,10481:16787697,10482:16787698,10483:16787699,10484:16787700,10485:16787701,10486:16787702,10487:16787703,10488:16787704,10489:16787705,10490:16787706,10491:16787707,10492:16787708,10493:16787709,10494:16787710,10495:16787711,12289:1188,12290:1185,12300:1186,12301:1187,12443:1246,12444:1247,12449:1191,12450:1201,12451:1192,12452:1202,12453:1193,12454:1203,12455:1194,12456:1204,12457:1195,12458:1205,12459:1206,12461:1207,12463:1208,12465:1209,12467:1210,12469:1211,12471:1212,12473:1213,12475:1214,12477:1215,12479:1216,12481:1217,12483:1199,12484:1218,12486:1219,12488:1220,12490:1221,12491:1222,12492:1223,12493:1224,12494:1225,12495:1226,12498:1227,12501:1228,12504:1229,12507:1230,12510:1231,12511:1232,12512:1233,12513:1234,12514:1235,12515:1196,12516:1236,12517:1197,12518:1237,12519:1198,12520:1238,12521:1239,12522:1240,12523:1241,12524:1242,12525:1243,12527:1244,12530:1190,12531:1245,12539:1189,12540:1200};
function r(t){return t?{keysym:t,keyname:e?e[t]:t}:void 0}return{fromUnicode:function(e){return r(t[e])},lookup:r}}(),u=function(){"use strict";function e(e){var t={536:350,537:351,538:354,539:355},r=t[e];return r?r:e}function t(){return navigator&&!!/mac/i.exec(navigator.platform)}function r(){return navigator&&!!/win/i.exec(navigator.platform)}function n(){return navigator&&!!/linux/i.exec(navigator.platform)}function i(e,t){var r={};for(var n in t)65505!==parseInt(n)&&(r[n]=t[n]);var i=0;for(var s in t)r[s]&&++i;return o(e,r)?i>e.length:i>0}function o(e,t){if(0===e.length)return!1;for(var r=0;r<e.length;++r)if(!t[e[r]])return!1;return!0}function s(e){var s=65507,u=65513,c=65027,h=65505,f=65511;e||(e=t()?[u]:r()?[u,s]:n()?[c]:[]);var d={};d[s]=!1,d[u]=!1,d[c]=!1,d[h]=!1,d[f]=!1;function p(e,t){var r=[];function n(e){return{keysym:a.lookup(e),type:d[e]?"keydown":"keyup"}}return void 0!==e.ctrlKey&&e.ctrlKey!==d[s]&&t!==s&&(d[s]=e.ctrlKey,r.push(n(s))),void 0!==e.altKey&&e.altKey!==d[u]&&t!==u&&(d[u]=e.altKey,r.push(n(u))),void 0!==e.altGraphKey&&e.altGraphKey!==d[c]&&t!==c&&(d[c]=e.altGraphKey,r.push(n(c))),void 0!==e.shiftKey&&e.shiftKey!==d[h]&&t!==h&&(d[h]=e.shiftKey,r.push(n(h))),void 0!==e.metaKey&&e.metaKey!==d[f]&&t!==f&&(d[f]=e.metaKey,r.push(n(f))),r}function m(e,t){var r=l(e),n=r?r.keysym:null;return null!==n&&void 0!==d[n]&&(d[n]=t),p(e,n)}return{keydown:function(e){return m(e,!0)},keyup:function(e){return m(e,!1)},syncAny:function(e){return p(e)},hasShortcutModifier:function(){return i(e,d)},activeCharModifier:function(){return o(e,d)?e:null}}}function u(e){return"keyCode"in e&&"key"in e?e.key+":"+e.keyCode:"keyCode"in e?e.keyCode:e.key}function l(t){var r;if(t.char&&1===t.char.length?r=t.char.charCodeAt():t.charCode?r=t.charCode:t.keyCode&&"keypress"===t.type&&(r=t.keyCode),r){var n=a.fromUnicode(e(r));if(n)return n}return t.keyCode?a.lookup(c(t.keyCode,t.shiftKey)):t.which?a.lookup(c(t.which,t.shiftKey)):null}function c(e,t){if("number"!=typeof e)return null;if(e>=48&&57>=e)return e;if(e>=65&&90>=e)return t?e:e+32;if(e>=96&&105>=e)return 65456+(e-96);switch(e){case 32:return 32;case 106:return 65450;case 107:return 65451;case 108:return 65452;case 109:return 65453;case 110:return 65454;case 111:return 65455;case 187:return 43;case 188:return 44;case 189:return 45;case 190:return 46}return h({keyCode:e})}function h(e){if(!e.keyCode)return null;var t=e.keyCode;if(t>=112&&135>=t)return 65470+t-112;switch(t){case 8:return 65288;case 13:return 65293;case 9:return 65289;case 27:return 65307;case 46:return 65535;case 36:return 65360;case 35:return 65367;case 33:return 65365;case 34:return 65366;case 45:return 65379;case 37:return 65361;case 38:return 65362;case 39:return 65363;case 40:return 65364;case 16:return 65505;case 17:return 65507;case 18:return 65513;case 224:return 65031;case 225:return 65027;case 91:return 65516;case 92:return 65517;case 93:return 65383;default:return null}}return{hasShortcutModifier:i,hasCharModifier:o,ModifierSync:s,getKey:u,getKeysym:l,keysymFromKeyCode:c,nonCharacterKey:h,substituteCodepoint:e}}();function l(e,t){"use strict";function r(e){for(var r=0;r<e.length;++r)t(e[r])}function n(r,n){var i={type:n},o=u.getKey(r);o&&(i.keyId=o);var s=u.getKeysym(r),a=e.hasShortcutModifier()||!!e.activeCharModifier();s&&("keydown"!==n||u.nonCharacterKey(r)||a)&&(i.keysym=s);var l=16===r.keyCode||"Shift"===r.key,c=!l&&("keydown"!==n||e.hasShortcutModifier()||!!u.nonCharacterKey(r)),h="keydown"===n&&e.activeCharModifier()&&!u.nonCharacterKey(r),f=e.activeCharModifier();if(f&&s){for(var d=!1,p=0;p<f.length;++p)f[p]===s.keysym&&(d=!0);"keypress"!==n||d||(i.escape=e.activeCharModifier())}return h&&t({type:"stall"}),t(i),c}return{keydown:function(t){return r(e.keydown(t)),n(t,"keydown")},keypress:function(e){return n(e,"keypress")},keyup:function(t){return r(e.keyup(t)),n(t,"keyup")},syncModifiers:function(t){r(e.syncAny(t))},releaseAll:function(){t({type:"releaseall"})}}}function c(e){"use strict";var t=[],r=null;function n(){if(!r)for(;0!==t.length;){var i=t[0];switch(t=t.splice(1),i.type){case"stall":return void(r=setTimeout(function(){clearTimeout(r),r=null,n()},5));case"keydown":0!==t.length&&"keypress"===t[0].type&&(!t[0].escape||i.keysym&&i.keysym.keysym===t[0].keysym.keysym||(i.escape=t[0].escape),i.keysym=t[0].keysym,t=t.splice(1))}"stall"!==i.type&&e(i)}}return function(e){t.push(e),n()}}function h(e){"use strict";var t=[];return function(r){var n=0!==t.length?t[t.length-1]:null;switch(r.type){case"keydown":n&&r.keyId&&n.keyId===r.keyId||(n={keyId:r.keyId,keysyms:{}},t.push(n)),r.keysym&&(n.keysyms[r.keysym.keysym]=r.keysym,n.ignoreKeyPress=!0,e(r));break;case"keypress":n||(n={keyId:r.keyId,keysyms:{}},t.push(n)),r.keysym||console.log("keypress with no keysym:",r),r.keysym&&!n.ignoreKeyPress&&(n.keysyms[r.keysym.keysym]=r.keysym,r.type="keydown",e(r));break;case"keyup":if(0===t.length)return;for(var i=null,o=0;o!==t.length;++o)if(t[o].keyId===r.keyId){i=o;break}null===i&&(i=t.length-1);var s=t.splice(i,1)[0];for(var a in s.keysyms){var u=function(){function e(){}return function(t){return e.prototype=t,new e}}(),l=u(r);l.keysym=s.keysyms[a],e(l)}break;case"releaseall":for(var o=0;o<t.length;++o)for(var a in t[o].keysyms){var c=t[o].keysyms[a];e({keyId:0,keysym:c,type:"keyup"})}t=[]}}}function f(e){"use strict";return function(t){if("keydown"!==t.type||void 0===t.escape)return void e(t);for(var r=0;r<t.escape.length;++r)e({type:"keyup",keyId:0,keysym:a.lookup(t.escape[r])});e(t);for(var r=0;r<t.escape.length;++r)e({type:"keydown",keyId:0,keysym:a.lookup(t.escape[r])})}}function d(t){"use strict";var n={},i={};r.conf_defaults(i,n,t,[["target","wo","dom",document,"DOM element that captures keyboard input"],["focused","rw","bool",!0,"Capture and send key events"],["onKeyPress","rw","func",null,"Handler for key press/release"]]);function o(e){i.onKeyPress&&(r.Debug("onKeyPress "+("keydown"==e.type?"down":"up")+", keysym: "+e.keysym.keysym+"("+e.keysym.keyname+")"),i.onKeyPress(e.keysym.keysym,"keydown"==e.type))}var s=l(u.ModifierSync(),c(h(f(o))));function a(e){return i.focused&&s.keydown(e)?(r.stopEvent(e),!1):!0}function d(e){return i.focused&&s.keypress(e)?(r.stopEvent(e),!1):!0}function p(e){return i.focused&&s.keyup(e)?(r.stopEvent(e),!1):!0}function m(){r.Debug(">> Keyboard.allKeysUp"),s.releaseAll(),r.Debug("<< Keyboard.allKeysUp")}return n.grab=function(){var t=i.target;r.addEvent(t,"keydown",a),r.addEvent(t,"keyup",p),r.addEvent(t,"keypress",d),r.addEvent(e,"blur",m)},n.ungrab=function(){var t=i.target;r.removeEvent(t,"keydown",a),r.removeEvent(t,"keyup",p),r.removeEvent(t,"keypress",d),r.removeEvent(e,"blur",m),m()},n.sync=function(e){s.syncModifiers(e)},n}function p(t){"use strict";var n={},i={},o=!1,s=null,a=null;r.conf_defaults(i,n,t,[["target","ro","dom",document,"DOM element that captures mouse input"],["notify","ro","func",null,"Function to call to notify whenever a mouse event is received"],["focused","rw","bool",!0,"Capture and send mouse clicks/movement"],["scale","rw","float",1,"Viewport scale factor 0.0 - 1.0"],["onMouseButton","rw","func",null,"Handler for mouse button click/release"],["onMouseMove","rw","func",null,"Handler for mouse movement"],["touchButton","rw","int",1,"Button mask (1, 2, 4) for touch devices (0 means ignore clicks)"]]);function u(){i.target.setCapture&&i.target.setCapture(),o=!0}function l(){i.target.releaseCapture&&i.target.releaseCapture(),o=!1}function c(){s=null}function h(t,n){var o,u,l;if(!i.focused)return!0;if(i.notify&&i.notify(t),o=t?t:e.event,u=r.getEventPosition(t,i.target,i.scale),t.touches||t.changedTouches){if(1==n){if(null==s)a=u;else{clearTimeout(s);var h=a.x-u.x,f=a.y-u.y,d=Math.sqrt(h*h+f*f);d<20*e.devicePixelRatio&&(u=a)}s=setTimeout(c,500)}l=i.touchButton}else l=o.which?1<<o.button:(1&o.button)+2*(2&o.button)+(4&o.button)/2;return i.onMouseButton&&(r.Debug("onMouseButton "+(n?"down":"up")+", x: "+u.x+", y: "+u.y+", bmask: "+l),i.onMouseButton(u.x,u.y,n,l)),r.stopEvent(t),!1}function f(e){u(),h(e,1)}function d(e){o&&(h(e,0),l())}function p(t){var n,o,s,a;return i.focused?(i.notify&&i.notify(t),n=t?t:e.event,o=r.getEventPosition(t,i.target,i.scale),a=n.detail?-1*n.detail:n.wheelDelta/40,s=a>0?8:16,i.onMouseButton&&(i.onMouseButton(o.x,o.y,1,s),i.onMouseButton(o.x,o.y,0,s)),r.stopEvent(t),!1):!0}function m(t){var n,o;return i.focused?(i.notify&&i.notify(t),n=t?t:e.event,o=r.getEventPosition(t,i.target,i.scale),i.onMouseMove&&i.onMouseMove(o.x,o.y),r.stopEvent(t),!1):!0}function b(t){var n,o;return i.focused?(n=t?t:e.event,o=r.getEventPosition(t,i.target,i.scale),o.realx>=0&&o.realy>=0&&o.realx<i.target.offsetWidth&&o.realy<i.target.offsetHeight?(r.stopEvent(t),!1):!0):!0}return n.grab=function(){var t=i.target;"ontouchstart"in document.documentElement?(r.addEvent(t,"touchstart",f),r.addEvent(e,"touchend",d),r.addEvent(t,"touchend",d),r.addEvent(t,"touchmove",m)):(r.addEvent(t,"mousedown",f),r.addEvent(e,"mouseup",d),r.addEvent(t,"mouseup",d),r.addEvent(t,"mousemove",m),r.addEvent(t,r.Engine.gecko?"DOMMouseScroll":"mousewheel",p)),r.addEvent(document,"click",b),r.addEvent(document.body,"contextmenu",b)},n.ungrab=function(){var t=i.target;"ontouchstart"in document.documentElement?(r.removeEvent(t,"touchstart",f),r.removeEvent(e,"touchend",d),r.removeEvent(t,"touchend",d),r.removeEvent(t,"touchmove",m)):(r.removeEvent(t,"mousedown",f),r.removeEvent(e,"mouseup",d),r.removeEvent(t,"mouseup",d),r.removeEvent(t,"mousemove",m),r.removeEvent(t,r.Engine.gecko?"DOMMouseScroll":"mousewheel",p)),r.removeEvent(document,"click",b),r.removeEvent(document.body,"contextmenu",b)},n}function m(e){"use strict";var t,n,i,o,s,a,u={},l={},c=null,h=[],f=0,d=0,p={x:0,y:0,w:0,h:0},m={x1:0,y1:0,x2:-1,y2:-1},g="",v=null,y=null,E=0,w=0;r.conf_defaults(l,u,e,[["target","wo","dom",null,"Canvas element for rendering"],["context","ro","raw",null,"Canvas 2D context for rendering (read-only)"],["logo","rw","raw",null,'Logo to display when cleared: {"width": width, "height": height, "data": data}'],["true_color","rw","bool",!0,"Use true-color pixel data"],["colourMap","rw","arr",[],"Colour map array (when not true-color)"],["scale","rw","float",1,"Display area scale factor 0.0 - 1.0"],["viewport","rw","bool",!1,"Use a viewport set with viewportChange()"],["width","rw","int",null,"Display area width"],["height","rw","int",null,"Display area height"],["render_mode","ro","str","","Canvas rendering mode (read-only)"],["prefer_js","rw","str",null,"Prefer Javascript over canvas methods"],["cursor_uri","rw","raw",null,"Can we render cursor using data URI"]]),u.get_context=function(){return c},u.set_scale=function(e){s(e)},u.set_width=function(e){u.resize(e,d)},u.get_width=function(){return f},u.set_height=function(e){u.resize(f,e)},u.get_height=function(){return d};function _(){r.Debug(">> Display.constructor");var e,t,n,i,o=r.Engine;if(!l.target)throw"target must be set";if("string"==typeof l.target)throw"target must be a DOM element";if(e=l.target,!e.getContext)throw"no getContext method";if(c||(c=e.getContext("2d")),r.Debug("User Agent: "+navigator.userAgent),o.gecko&&r.Debug("Browser: gecko "+o.gecko),o.webkit&&r.Debug("Browser: webkit "+o.webkit),o.trident&&r.Debug("Browser: trident "+o.trident),o.presto&&r.Debug("Browser: presto "+o.presto),u.clear(),!("createImageData"in c))throw"Canvas does not support createImageData";for(l.render_mode="canvas rendering",null===l.prefer_js&&(r.Info("Prefering javascript operations"),l.prefer_js=!0),y=c.createImageData(16,16),n=[],t=0;256>t;t+=1)n.push(255);try{i=e.style.cursor,b(l.target,n,n,2,2,8,8),e.style.cursor?(null===l.cursor_uri&&(l.cursor_uri=!0),r.Info("Data URI scheme cursor supported")):(null===l.cursor_uri&&(l.cursor_uri=!1),r.Warn("Data URI scheme cursor not supported")),e.style.cursor=i}catch(s){r.Error("Data URI scheme cursor test exception: "+s),l.cursor_uri=!1}return r.Debug("<< Display.constructor"),u}return s=function(e){var t,n,i,o,s=["transform","WebkitTransform","MozTransform",null];for(t=l.target,n=s.shift();n&&"undefined"==typeof t.style[n];)n=s.shift();return null===n?void r.Debug("No scaling support"):("undefined"==typeof e?e=l.scale:e>1?e=1:.1>e&&(e=.1),void(l.scale!==e&&(l.scale=e,i=t.width-t.width*e,o=t.height-t.height*e,t.style[n]="scale("+l.scale+") translate(-"+i+"px, -"+o+"px)")))},o=function(e){var t,r;t=l.true_color?e:l.colourMap[e[0]],r="rgb("+t[2]+","+t[1]+","+t[0]+")",r!==g&&(c.fillStyle=r,g=r)},u.viewportChange=function(e,t,n,i){var o,s,a,u,h,b,g,v=l.target,y=p,E=m,w=null;l.viewport||(r.Debug("Setting viewport to full display region"),e=-y.w,t=-y.h,n=f,i=d),"undefined"==typeof e&&(e=0),"undefined"==typeof t&&(t=0),"undefined"==typeof n&&(n=y.w),"undefined"==typeof i&&(i=y.h),n>f&&(n=f),i>d&&(i=d),(y.w!==n||y.h!==i)&&(n<y.w&&E.x2>y.x+n-1&&(E.x2=y.x+n-1),y.w=n,i<y.h&&E.y2>y.y+i-1&&(E.y2=y.y+i-1),y.h=i,y.w>0&&y.h>0&&v.width>0&&v.height>0&&(w=c.getImageData(0,0,v.width<y.w?v.width:y.w,v.height<y.h?v.height:y.h)),v.width=y.w,v.height=y.h,w&&c.putImageData(w,0,0)),u=y.x+y.w-1,h=y.y+y.h-1,0>e&&y.x+e<0&&(e=-y.x),u+e>=f&&(e-=u+e-f+1),y.y+t<0&&(t=-y.y),h+t>=d&&(t-=h+t-d+1),(0!==e||0!==t)&&(r.Debug("viewportChange deltaX: "+e+", deltaY: "+t),y.x+=e,u+=e,y.y+=t,h+=t,y.x>E.x1&&(E.x1=y.x),u<E.x2&&(E.x2=u),y.y>E.y1&&(E.y1=y.y),h<E.y2&&(E.y2=h),0>e?(s=0,b=-e):(s=y.w-e,b=e),0>t?(a=0,g=-t):(a=y.h-t,g=t),o=c.fillStyle,c.fillStyle="rgb(255,255,255)",0!==e&&(c.drawImage(v,0,0,y.w,y.h,-e,0,y.w,y.h),c.fillRect(s,0,b,y.h)),0!==t&&(c.drawImage(v,0,0,y.w,y.h,0,-t,y.w,y.h),c.fillRect(0,a,y.w,g)),c.fillStyle=o)},u.getCleanDirtyReset=function(){var e,t=p,r=m,n=[],i=t.x+t.w-1,o=t.y+t.h-1;return e={x:r.x1,y:r.y1,w:r.x2-r.x1+1,h:r.y2-r.y1+1},r.x1>=r.x2||r.y1>=r.y2?n.push({x:t.x,y:t.y,w:t.w,h:t.h}):(t.x<r.x1&&n.push({x:t.x,y:t.y,w:r.x1-t.x+1,h:t.h}),i>r.x2&&n.push({x:r.x2+1,y:t.y,w:i-r.x2,h:t.h}),t.y<r.y1&&n.push({x:r.x1,y:t.y,w:r.x2-r.x1+1,h:r.y1-t.y}),o>r.y2&&n.push({x:r.x1,y:r.y2+1,w:r.x2-r.x1+1,h:o-r.y2})),m={x1:t.x,y1:t.y,x2:t.x+t.w-1,y2:t.y+t.h-1},{cleanBox:e,dirtyBoxes:n}},u.absX=function(e){return e+p.x},u.absY=function(e){return e+p.y},u.resize=function(e,t){g="",f=e,d=t,s(l.scale),u.viewportChange()},u.clear=function(){l.logo?(u.resize(l.logo.width,l.logo.height),u.blitStringImage(l.logo.data,0,0)):(u.resize(640,20),c.clearRect(0,0,p.w,p.h)),h=[]},u.fillRect=function(e,t,r,n,i){o(i),c.fillRect(e-p.x,t-p.y,r,n)},u.copyImage=function(e,t,r,n,i,o){var s=e-p.x,a=t-p.y,u=r-p.x,h=n-p.y;c.drawImage(l.target,s,a,i,o,u,h,i,o)},u.startTile=function(e,t,r,n,i){var o,s,a,h,f,d;if(E=e,w=t,v=16===r&&16===n?y:c.createImageData(r,n),o=v.data,l.prefer_js)for(s=l.true_color?i:l.colourMap[i[0]],a=s[2],h=s[1],f=s[0],d=0;r*n*4>d;d+=4)o[d]=a,o[d+1]=h,o[d+2]=f,o[d+3]=255;else u.fillRect(e,t,r,n,i)},u.subTile=function(e,t,r,n,i){var o,s,a,c,h,f,d,p,m,b,g;if(l.prefer_js)for(o=v.data,d=v.width,a=l.true_color?i:l.colourMap[i[0]],c=a[2],h=a[1],f=a[0],b=e+r,g=t+n,p=t;g>p;p+=1)for(m=e;b>m;m+=1)s=4*(m+p*d),o[s]=c,o[s+1]=h,o[s+2]=f,o[s+3]=255;else u.fillRect(E+e,w+t,r,n,i)},u.finishTile=function(){l.prefer_js&&c.putImageData(v,E-p.x,w-p.y)},t=function(e,t,r,n,i,o,s,a){var u,l,h,f;for(u=c.createImageData(i,o),f=u.data,l=0,h=a;i*o*4>l;l+=4,h+=3)f[l]=s[h],f[l+1]=s[h+1],f[l+2]=s[h+2],f[l+3]=255;c.putImageData(u,e-r,t-n)},n=function(e,t,r,n,i,o,s,a){var u,l,h,f;for(u=c.createImageData(i,o),f=u.data,l=0,h=a;i*o*4>l;l+=4,h+=4)f[l]=s[h+2],f[l+1]=s[h+1],f[l+2]=s[h],f[l+3]=255;c.putImageData(u,e-r,t-n)},i=function(e,t,r,n,i,o,s,a){var u,h,f,d,p,m;for(u=c.createImageData(i,o),d=u.data,m=l.colourMap,h=0,f=a;i*o*4>h;h+=4,f+=1)p=m[s[f]],d[h]=p[2],d[h+1]=p[1],d[h+2]=p[0],d[h+3]=255;c.putImageData(u,e-r,t-n)},u.blitImage=function(e,t,r,o,s,a){l.true_color?n(e,t,p.x,p.y,r,o,s,a):i(e,t,p.x,p.y,r,o,s,a)},u.blitRgbImage=function(e,r,n,o,s,a){l.true_color?t(e,r,p.x,p.y,n,o,s,a):i(e,r,p.x,p.y,n,o,s,a)},u.blitStringImage=function(e,t,r){var n=new Image;n.onload=function(){c.drawImage(n,t-p.x,r-p.y)},n.src=e},u.drawImage=function(e,t,r){c.drawImage(e,t-p.x,r-p.y)},u.renderQ_push=function(e){h.push(e),1===h.length&&a()},a=function(){for(var e,t=!0;t&&h.length>0;){switch(e=h[0],e.type){case"copy":u.copyImage(e.old_x,e.old_y,e.x,e.y,e.width,e.height);break;case"fill":u.fillRect(e.x,e.y,e.width,e.height,e.color);break;case"blit":u.blitImage(e.x,e.y,e.width,e.height,e.data,0);break;case"blitRgb":u.blitRgbImage(e.x,e.y,e.width,e.height,e.data,0);break;case"img":e.img.complete?u.drawImage(e.img,e.x,e.y):t=!1}t&&(e=h.shift())}h.length>0&&requestAnimFrame(a)},u.changeCursor=function(e,t,n,i,o,s){return l.cursor_uri===!1?void r.Warn("changeCursor called but no cursor data URI support"):void(l.true_color?b(l.target,e,t,n,i,o,s):b(l.target,e,t,n,i,o,s,l.colourMap))},u.defaultCursor=function(){l.target.style.cursor="default"},_()}function b(e,t,r,n,o,s,a,u){"use strict";var l,c,h,f,d,p,m,b,g,v,y=[],E=s,w=a;for(E>w?w=E:E=w,y.push16le=function(e){this.push(255&e,e>>8&255)},y.push32le=function(e){this.push(255&e,e>>8&255,e>>16&255,e>>24&255)},c=40,h=E*w*4,d=Math.ceil(E*w/8),f=Math.ceil(E*w/8),y.push16le(0),y.push16le(2),y.push16le(1),y.push(E),y.push(w),y.push(0),y.push(0),y.push16le(n),y.push16le(o),y.push32le(c+h+d+f),y.push32le(22),y.push32le(c),y.push32le(E),y.push32le(2*w),y.push16le(1),y.push16le(32),y.push32le(0),y.push32le(d+f),y.push32le(0),y.push32le(0),y.push32le(0),y.push32le(0),v=w-1;v>=0;v-=1)for(g=0;E>g;g+=1)g>=s||v>=a?(y.push(0),y.push(0),y.push(0),y.push(0)):(m=v*Math.ceil(s/8)+Math.floor(g/8),b=r[m]<<g%8&128?255:0,u?(m=s*v+g,l=u[t[m]],y.push(l[2]),y.push(l[1]),y.push(l[0]),y.push(b)):(m=4*(s*v+g),y.push(t[m+2]),y.push(t[m+1]),y.push(t[m]),y.push(b)));for(v=0;w>v;v+=1)for(g=0;g<Math.ceil(E/8);g+=1)y.push(0);for(v=0;w>v;v+=1)for(g=0;g<Math.ceil(E/8);g+=1)y.push(0);p="data:image/x-icon;base64,"+i.encode(y),e.style.cursor="url("+p+") "+n+" "+o+", default"}function g(){this.OK=0,this.DATA_ERROR=-3,this.WINDOW_SIZE=32768,this.TREE=function(){this.table=new Array(16),this.trans=new Array(288)},this.DATA=function(e){this.source="",this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=[],this.history=[],this.ltree=new e.TREE,this.dtree=new e.TREE},this.sltree=new this.TREE,this.sdtree=new this.TREE,this.length_bits=new Array(30),this.length_base=new Array(30),this.dist_bits=new Array(30),this.dist_base=new Array(30),this.clcidx=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],this.build_bits_base=function(e,t,r,n){var i,o;for(i=0;r>i;++i)e[i]=0;for(i=0;30-r>i;++i)e[i+r]=Math.floor(i/r);for(o=n,i=0;30>i;++i)t[i]=o,o+=1<<e[i]},this.build_fixed_trees=function(e,t){var r;for(r=0;7>r;++r)e.table[r]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,r=0;24>r;++r)e.trans[r]=256+r;for(r=0;144>r;++r)e.trans[24+r]=r;for(r=0;8>r;++r)e.trans[168+r]=280+r;for(r=0;112>r;++r)e.trans[176+r]=144+r;for(r=0;5>r;++r)t.table[r]=0;for(t.table[5]=32,r=0;32>r;++r)t.trans[r]=r},this.build_tree=function(e,t,r,n){var i,o,s=new Array(16);for(i=0;16>i;++i)e.table[i]=0;for(i=0;n>i;++i)e.table[t[r+i]]++;for(e.table[0]=0,o=0,i=0;16>i;++i)s[i]=o,o+=e.table[i];for(i=0;n>i;++i)t[r+i]&&(e.trans[s[t[r+i]]++]=i)},this.getbit=function(e){var t;return e.bitcount--||(e.tag=255&e.source[e.sourceIndex++],e.bitcount=7),t=1&e.tag,e.tag>>=1,t};function e(e,t,r,n,i){for(var o=0;24>t;)r|=(255&e[n++])<<t,t+=8;return o=r&65535>>16-i,r>>=i,t-=i,[t,r,n,o]}this.read_bits=function(t,r,n){if(!r)return n;var i=e(t.source,t.bitcount,t.tag,t.sourceIndex,r);return t.bitcount=i[0],t.tag=i[1],t.sourceIndex=i[2],i[3]+n},this.decode_symbol=function(e,t){for(;e.bitcount<16;)e.tag=e.tag|(255&e.source[e.sourceIndex++])<<e.bitcount,e.bitcount+=8;var r=0,n=0,i=0;do n=2*n+((e.tag&1<<i)>>i),++i,r+=t.table[i],n-=t.table[i];while(n>=0);return e.tag>>=i,e.bitcount-=i,t.trans[r+n]},this.decode_trees=function(e,t,r){var n,i,o,s,a,u,l=new this.TREE,c=new Array(320);for(n=this.read_bits(e,5,257),i=this.read_bits(e,5,1),o=this.read_bits(e,4,4),s=0;19>s;++s)c[s]=0;for(s=0;o>s;++s){var h=this.read_bits(e,3,0);c[this.clcidx[s]]=h}for(this.build_tree(l,c,0,19),a=0;n+i>a;){var f=this.decode_symbol(e,l);switch(f){case 16:var d=c[a-1];for(u=this.read_bits(e,2,3);u;--u)c[a++]=d;break;case 17:for(u=this.read_bits(e,3,3);u;--u)c[a++]=0;break;case 18:for(u=this.read_bits(e,7,11);u;--u)c[a++]=0;break;default:c[a++]=f}}this.build_tree(t,c,0,n),this.build_tree(r,c,n,i)},this.inflate_block_data=function(e,t,r){for(var n=e.dest,i=n.length;;){var o=this.decode_symbol(e,t);if(256==o)return this.OK;if(256>o)n[i++]=o,e.history.push(o);else{var s,a,u,l;if(o-=257,s=this.read_bits(e,this.length_bits[o],this.length_base[o]),a=this.decode_symbol(e,r),u=e.history.length-this.read_bits(e,this.dist_bits[a],this.dist_base[a]),0>u)throw"Invalid zlib offset "+u;for(l=u;u+s>l;++l)n[i++]=e.history[l],e.history.push(e.history[l])}}},this.inflate_uncompressed_block=function(e){var t,r,n;if(e.bitcount>7){var i=Math.floor(e.bitcount/8);e.sourceIndex-=i,e.bitcount=0,e.tag=0}if(t=e.source[e.sourceIndex+1],t=256*t+e.source[e.sourceIndex],r=e.source[e.sourceIndex+3],r=256*r+e.source[e.sourceIndex+2],t!=(65535&~r))return this.DATA_ERROR;for(e.sourceIndex+=4,n=t;n;--n)e.history.push(e.source[e.sourceIndex]),e.dest[e.dest.length]=e.source[e.sourceIndex++];return e.bitcount=0,this.OK},this.inflate_fixed_block=function(e){return this.inflate_block_data(e,this.sltree,this.sdtree)},this.inflate_dynamic_block=function(e){return this.decode_trees(e,e.ltree,e.dtree),this.inflate_block_data(e,e.ltree,e.dtree)},this.init=function(){this.build_fixed_trees(this.sltree,this.sdtree),this.build_bits_base(this.length_bits,this.length_base,4,3),this.build_bits_base(this.dist_bits,this.dist_base,2,1),this.length_bits[28]=0,this.length_base[28]=258,this.reset()},this.reset=function(){this.d=new this.DATA(this),delete this.header},this.uncompress=function(e,t){var r,n=this.d;n.source=e,n.sourceIndex=t,n.bitcount=0,n.dest=[],"undefined"==typeof this.header&&(this.header=this.read_bits(n,16,0));var i=0;do{var o,s;switch(r=this.getbit(n),o=this.read_bits(n,2,0)){case 0:s=this.inflate_uncompressed_block(n);break;case 1:s=this.inflate_fixed_block(n);break;case 2:s=this.inflate_dynamic_block(n);break;default:return{status:this.DATA_ERROR}}if(s!=this.OK)return{status:this.DATA_ERROR};i++}while(!r&&n.sourceIndex<n.source.length);return n.history=n.history.slice(-this.WINDOW_SIZE),{status:this.OK,data:n.dest}}}function v(e){"use strict";var n,a,u,l,c,h,f,b,v,y,E,w,_,C,x,T,k,O,A,S,D,P={},I={},N="",M=5900,R="",j="",V="disconnected",L=0,H=3.8,F="",B=!1,U=0,W=[["COPYRECT",1],["TIGHT",7],["TIGHT_PNG",-260],["HEXTILE",5],["RRE",2],["RAW",0],["DesktopSize",-223],["Cursor",-239],["JPEG_quality_med",-26],["compress_hi",-247],["last_rect",-224],["xvp",-309]],$={},q={},Y={},z=null,G=null,K=null,Q=null,X=null,Z=null,J=null,et={rects:0,subrects:0,lines:0,tiles:0,bytes:0,x:0,y:0,width:0,height:0,encoding:0,subencoding:-1,background:null,zlibs:[]},tt=4,rt=3,nt=0,it=0,ot="",st=100,at={last_fbu:0,fbu_total:0,fbu_total_cnt:0,full_fbu_total:0,full_fbu_cnt:0,fbu_rt_start:0,fbu_rt_total:0,fbu_rt_cnt:0,pixels:0},ut=!1,lt=0,ct=[],ht=!1,ft={};r.conf_defaults(I,P,e,[["target","wo","dom",null,"VNC display rendering Canvas object"],["focusContainer","wo","dom",document,"DOM element that captures keyboard input"],["encrypt","rw","bool",!1,"Use TLS/SSL/wss encryption"],["true_color","rw","bool",!0,"Request true color pixel data"],["local_cursor","rw","bool",!1,"Request locally rendered cursor"],["shared","rw","bool",!0,"Request shared mode"],["view_only","rw","bool",!1,"Disable client mouse/keyboard"],["xvp_password_sep","rw","str","@","Separator for XVP password fields"],["disconnectTimeout","rw","int",3,"Time (s) to wait for disconnection"],["wsProtocols","rw","arr",["binary","base64"],"Protocols to use in the WebSocket connection"],["repeaterID","rw","str","","RepeaterID to connect to"],["viewportDrag","rw","bool",!1,"Move the viewport on mouse drags"],["onUpdateState","rw","func",function(){},"onUpdateState(rfb, state, oldstate, statusMsg): RFB state update/change "],["onPasswordRequired","rw","func",function(){},"onPasswordRequired(rfb): VNC password is required "],["onClipboard","rw","func",function(){},"onClipboard(rfb, text): RFB clipboard contents received"],["onBell","rw","func",function(){},"onBell(rfb): RFB Bell message received "],["onFBUReceive","rw","func",function(){},"onFBUReceive(rfb, fbu): RFB FBU received but not yet processed "],["onFBUComplete","rw","func",function(){},"onFBUComplete(rfb, fbu): RFB FBU received and processed "],["onFBResize","rw","func",function(){},"onFBResize(rfb, width, height): frame buffer resized"],["onDesktopName","rw","func",function(){},"onDesktopName(rfb, name): desktop name received"],["onXvpInit","rw","func",function(){},"onXvpInit(version): XVP extensions active for this connection"],["updateState","rw","func",function(){},"obsolete, use onUpdateState"],["clipboardReceive","rw","func",function(){},"obsolete, use onClipboard"]]),P.set_local_cursor=function(e){!e||e in{0:1,no:1,"false":1}?I.local_cursor=!1:G.get_cursor_uri()?I.local_cursor=!0:r.Warn("Browser does not support local cursor")},P.get_display=function(){return G},P.get_keyboard=function(){return K},P.get_mouse=function(){return Q};function dt(){var e,i;for(r.Debug(">> RFB.constructor"),e=0;e<W.length;e+=1)$[W[e][1]]=$[W[e][0]],q[W[e][1]]=W[e][0],Y[W[e][1]]=[0,0];try{G=new m({target:I.target})}catch(s){r.Error("Display exception: "+s),a("fatal","No working Display")}return K=new d({target:I.focusContainer,onKeyPress:O}),Q=new p({target:I.target,onMouseButton:A,onMouseMove:S,notify:K.sync}),i=G.get_render_mode(),z=new o,z.on("message",l),z.on("open",function(){"connect"===V?a("ProtocolVersion","Starting VNC handshake"):u("Got unexpected WebSockets connection")}),z.on("close",function(e){r.Warn("WebSocket on-close event");var t="";e.code&&(t=" (code: "+e.code,e.reason&&(t+=", reason: "+e.reason),t+=")"),"disconnect"===V?a("disconnected","VNC disconnected"+t):"ProtocolVersion"===V?u("Failed to connect to server"+t):V in{failed:1,disconnected:1}?r.Error("Received onclose while disconnected"+t):u("Server disconnected"+t)}),z.on("error",function(){r.Warn("WebSocket on-error event")}),n(),t?(r.Info("Using native WebSockets"),a("loaded","noVNC ready: native WebSockets, "+i)):(r.Warn("Using web-socket-js bridge. Flash version: "+r.Flash.version),!r.Flash||r.Flash.version<9?a("fatal","WebSockets or <a href='http://get.adobe.com/flashplayer'>Adobe Flash</a> is required"):"file://"===document.location.href.substr(0,7)?a("fatal","'file://' URL is incompatible with Adobe Flash"):a("loaded","noVNC ready: WebSockets emulation, "+i)),r.Debug("<< RFB.constructor"),P}function pt(){r.Debug(">> RFB.connect");var e;e="undefined"!=typeof UsingSocketIO?"http":I.encrypt?"wss":"ws",e+="://"+N+":"+M+"/"+j,r.Info("connecting to "+e),z.open(e,I.wsProtocols),r.Debug("<< RFB.connect")}n=function(){var e;for(z.init(),et.rects=0,et.subrects=0,et.lines=0,et.tiles=0,et.zlibs=[],lt=0,ct=[],e=0;e<W.length;e+=1)Y[W[e][1]][0]=0;for(e=0;4>e;e++)et.zlibs[e]=new g,et.zlibs[e].init()},b=function(){var e,t;for(r.Info("Encoding stats for this connection:"),e=0;e<W.length;e+=1)t=Y[W[e][1]],t[0]+t[1]>0&&r.Info("    "+W[e][0]+": "+t[0]+" rects");for(r.Info("Encoding stats since page load:"),e=0;e<W.length;e+=1)t=Y[W[e][1]],t[0]+t[1]>0&&r.Info("    "+W[e][0]+": "+t[1]+" rects")},a=function(e,t){var i,o,s=V;if(e===s)return void r.Debug("Already in state '"+e+"', ignoring.");switch(e in{disconnected:1,loaded:1,connect:1,disconnect:1,failed:1,fatal:1}&&(X&&(clearInterval(X),X=null),J&&(clearTimeout(J),J=null),G&&G.get_context()&&(K.ungrab(),Q.ungrab(),G.defaultCursor(),("debug"!==r.get_logging()||"loaded"===e)&&G.clear()),z.close()),"fatal"===s&&r.Error("Fatal error, cannot continue"),i="failed"===e||"fatal"===e?r.Error:r.Warn,o="undefined"!=typeof t?" Msg: "+t:"",i("New state '"+e+"', was '"+s+"'."+o),V="failed"===s&&"disconnected"===e?"failed":e,Z&&"disconnect"!==V&&(r.Debug("Clearing disconnect timer"),clearTimeout(Z),Z=null),e){case"normal":("disconnected"===s||"failed"===s)&&r.Error("Invalid transition from 'disconnected' or 'failed' to 'normal'");break;case"connect":n(),pt();break;case"disconnect":ut||(Z=setTimeout(function(){u("Disconnect timeout")},1e3*I.disconnectTimeout)),b();break;case"failed":"disconnected"===s&&r.Error("Invalid transition from 'disconnected' to 'failed'"),"normal"===s&&r.Error("Error while connected."),"init"===s&&r.Error("Error while initializing."),setTimeout(function(){a("disconnected")},50)}"failed"===s&&"disconnected"===e?(I.updateState(P,e,s),I.onUpdateState(P,e,s)):(I.updateState(P,e,s,t),I.onUpdateState(P,e,s,t))},u=function(e){return a("failed",e),!1},l=function(){if(0===z.rQlen())return void r.Warn("handle_message called on empty receive queue");switch(V){case"disconnected":case"failed":r.Error("Got data while disconnected");break;case"normal":h()&&z.rQlen()>0&&(null===J?(r.Debug("More data to process, creating timer"),J=setTimeout(function(){J=null,l()},10)):r.Debug("More data to process, existing timer"));break;default:c()}};function mt(e,t){var r,n=[];for(r=0;r<e.length;r+=1)n.push(e.charCodeAt(r));return new s(n).encrypt(t)}D=function(){"normal"===V&&!ht&&ct.length>0&&(z.send(ct),ct=[])},O=function(e,t){I.view_only||z.send(_(e,t))},A=function(e,t,r,n){if(r?lt|=n:lt^=n,I.viewportDrag){if(r&&!ht)return ht=!0,void(ft={x:e,y:t});ht=!1}I.view_only||(ct=ct.concat(C(G.absX(e),G.absY(t))),z.send(ct),ct=[])},S=function(e,t){var r,n;return ht?(r=ft.x-e,n=ft.y-t,ft={x:e,y:t},void G.viewportChange(r,n)):void(I.view_only||(ct=ct.concat(C(G.absX(e),G.absY(t))),D()))},c=function(){var e,t,n,i,o,s,l,h,f,d,p,m,b,g,E,_,C,x,T,k,O,A,S,N,M,j;switch(V){case"ProtocolVersion":if(z.rQlen()<12)return u("Incomplete protocol version");switch(i=z.rQshiftStr(12).substr(4,7),r.Info("Server ProtocolVersion: "+i),S=0,i){case"000.000":S=1;break;case"003.003":L=3.3;break;case"003.006":L=3.3;break;case"003.889":L=3.3;break;case"003.007":L=3.7;break;case"003.008":L=3.8;break;case"004.000":L=3.8;break;case"004.001":L=3.8;break;default:return u("Invalid server version "+i)}if(S){for(s=I.repeaterID;s.length<250;)s+="\x00";z.send_string(s);break}L>H&&(L=H),ut||(X=setInterval(function(){z.flush()},50)),o="00"+parseInt(L,10)+".00"+10*L%10,z.send_string("RFB "+o+"\n"),a("Security","Sent ProtocolVersion: "+o);break;case"Security":if(L>=3.7){if(f=z.rQshift8(),z.rQwait("security type",f,1))return!1;if(0===f)return e=z.rQshift32(),t=z.rQshiftStr(e),u("Security failure: "+t);for(F=0,h=z.rQshiftBytes(f),r.Debug("Server security types: "+h),l=0;l<h.length;l+=1)h[l]>F&&(h[l]<=16||22==h[l])&&(F=h[l]);if(0===F)return u("Unsupported security types: "+h);z.send([F])}else{if(z.rQwait("security scheme",4))return!1;F=z.rQshift32()}a("Authentication","Authenticating using scheme: "+F),c();break;case"Authentication":switch(F){case 0:return z.rQwait("auth reason",4)?!1:(e=z.rQshift32(),t=z.rQshiftStr(e),u("Auth failure: "+t));case 1:if(L>=3.8)return void a("SecurityResult");break;case 22:if(N=I.xvp_password_sep,M=R.split(N),M.length<3)return a("password","XVP credentials required (user"+N+"target"+N+"password) -- got only "+R),void I.onPasswordRequired(P);j=String.fromCharCode(M[0].length)+String.fromCharCode(M[1].length)+M[0]+M[1],z.send_string(j),R=M.slice(2).join(N),F=2;case 2:return 0===R.length?(a("password","Password Required"),void I.onPasswordRequired(P)):z.rQwait("auth challenge",16)?!1:(d=z.rQshiftBytes(16),p=mt(R,d),z.send(p),void a("SecurityResult"));case 16:if(z.rQwait("num tunnels",4))return!1;var U=z.rQshift32();if(B=!0,0!=U)return void u("Protocol requested tunnels, not currently supported. numTunnels: "+U);var W={STDVNOAUTH__:1,STDVVNCAUTH_:2},$=[];if(z.rQwait("sub auth count",4))return!1;for(var q=z.rQshift32(),l=0;q>l;l++){if(z.rQwait("sub auth capabilities "+l,16))return!1;var Y=(z.rQshift32(),z.rQshiftStr(12));$.push(Y)}for(var Z in W)if(-1!=$.indexOf(Z))switch(z.send([0,0,0,W[Z]]),Z){case"STDVNOAUTH__":return void a("SecurityResult");case"STDVVNCAUTH_":return F=2,void c();
default:return void u("Unsupported tiny auth scheme: "+Z)}return;default:return void u("Unsupported auth scheme: "+F)}a("ClientInitialisation","No auth required"),c();break;case"SecurityResult":if(z.rQwait("VNC auth response ",4))return!1;switch(z.rQshift32()){case 0:break;case 1:if(L>=3.8){if(n=z.rQshift32(),z.rQwait("SecurityResult reason",n,8))return!1;t=z.rQshiftStr(n),u(t)}else u("Authentication failed");return;case 2:return u("Too many auth attempts")}a("ClientInitialisation","Authentication OK"),c();break;case"ClientInitialisation":z.send([I.shared?1:0]),a("ServerInitialisation","Authentication OK");break;case"ServerInitialisation":if(z.rQwait("server initialization",24))return!1;if(nt=z.rQshift16(),it=z.rQshift16(),m=z.rQshift8(),b=z.rQshift8(),g=z.rQshift8(),O=z.rQshift8(),E=z.rQshift16(),_=z.rQshift16(),C=z.rQshift16(),x=z.rQshift8(),T=z.rQshift8(),k=z.rQshift8(),z.rQshiftStr(3),r.Info("Screen: "+nt+"x"+it+", bpp: "+m+", depth: "+b+", big_endian: "+g+", true_color: "+O+", red_max: "+E+", green_max: "+_+", blue_max: "+C+", red_shift: "+x+", green_shift: "+T+", blue_shift: "+k),0!==g&&r.Warn("Server native endian is not little endian"),16!==x&&r.Warn("Server native red-shift is not 16"),0!==k&&r.Warn("Server native blue-shift is not 0"),A=z.rQshift32(),ot=r.decodeUTF8(z.rQshiftStr(A)),I.onDesktopName(P,ot),I.true_color&&"Intel(r) AMT KVM"===ot&&(r.Warn("Intel AMT KVM only support 8/16 bit depths. Disabling true color"),I.true_color=!1),B){var J=z.rQshift16(),et=z.rQshift16(),st=z.rQshift16();z.rQshift16();for(var l=0;J>l;l++){z.rQshiftStr(16)}for(var l=0;et>l;l++){z.rQshiftStr(16)}for(var l=0;st>l;l++){z.rQshiftStr(16)}}G.set_true_color(I.true_color),I.onFBResize(P,nt,it),G.resize(nt,it),K.grab(),Q.grab(),I.true_color?(tt=4,rt=3):(tt=1,rt=1),p=v(),p=p.concat(y()),p=p.concat(w()),at.fbu_rt_start=(new Date).getTime(),at.pixels=0,z.send(p),D(),I.encrypt?a("normal","Connected (encrypted) to: "+ot):a("normal","Connected (unencrypted) to: "+ot)}},h=function(){var e,t,n,i,o,s,l,c,h,d,p,m=!0;switch(e=et.rects>0?0:z.rQshift8()){case 0:m=f(),m&&z.send(w());break;case 1:if(r.Debug("SetColourMapEntries"),z.rQshift8(),o=z.rQshift16(),s=z.rQshift16(),z.rQwait("SetColourMapEntries",6*s,6))return!1;for(i=0;s>i;i+=1)l=z.rQshift16(),l=parseInt(l/256,10),c=parseInt(z.rQshift16()/256,10),h=parseInt(z.rQshift16()/256,10),G.set_colourMap([h,c,l],o+i);r.Debug("colourMap: "+G.get_colourMap()),r.Info("Registered "+s+" colourMap entries");break;case 2:r.Debug("Bell"),I.onBell(P);break;case 3:if(r.Debug("ServerCutText"),z.rQwait("ServerCutText header",7,1))return!1;if(z.rQshiftBytes(3),t=z.rQshift32(),z.rQwait("ServerCutText",t,8))return!1;n=z.rQshiftStr(t),I.clipboardReceive(P,n),I.onClipboard(P,n);break;case 250:switch(z.rQshift8(),d=z.rQshift8(),p=z.rQshift8()){case 0:a(V,"Operation failed");break;case 1:U=d,r.Info("XVP extensions enabled (version "+U+")"),I.onXvpInit(U);break;default:u("Disconnected: illegal server XVP message "+p)}break;default:u("Disconnected: illegal server message type "+e),r.Debug("ws.rQslice(0,30):"+z.rQslice(0,30))}return m},f=function(){var e,t,n,i=!0;if(0===et.rects){if(z.rQwait("FBU header",3))return z.rQunshift8(0),!1;z.rQshift8(),et.rects=z.rQshift16(),et.bytes=0,at.cur_fbu=0,at.fbu_rt_start>0&&(e=(new Date).getTime(),r.Info("First FBU latency: "+(e-at.fbu_rt_start)))}for(;et.rects>0;){if("normal"!==V)return!1;if(z.rQwait("FBU",et.bytes))return!1;if(0===et.bytes){if(z.rQwait("rect header",12))return!1;if(t=z.rQshiftBytes(12),et.x=(t[0]<<8)+t[1],et.y=(t[2]<<8)+t[3],et.width=(t[4]<<8)+t[5],et.height=(t[6]<<8)+t[7],et.encoding=parseInt((t[8]<<24)+(t[9]<<16)+(t[10]<<8)+t[11],10),I.onFBUReceive(P,{x:et.x,y:et.y,width:et.width,height:et.height,encoding:et.encoding,encodingName:q[et.encoding]}),!q[et.encoding])return u("Disconnected: unsupported encoding "+et.encoding),!1}if(at.last_fbu=(new Date).getTime(),i=$[et.encoding](),e=(new Date).getTime(),at.cur_fbu+=e-at.last_fbu,i&&(Y[et.encoding][0]+=1,Y[et.encoding][1]+=1,at.pixels+=et.width*et.height),at.pixels>=nt*it&&((et.width===nt&&et.height===it||at.fbu_rt_start>0)&&(at.full_fbu_total+=at.cur_fbu,at.full_fbu_cnt+=1,r.Info("Timing of full FBU, cur: "+at.cur_fbu+", total: "+at.full_fbu_total+", cnt: "+at.full_fbu_cnt+", avg: "+at.full_fbu_total/at.full_fbu_cnt)),at.fbu_rt_start>0&&(n=e-at.fbu_rt_start,at.fbu_rt_total+=n,at.fbu_rt_cnt+=1,r.Info("full FBU round-trip, cur: "+n+", total: "+at.fbu_rt_total+", cnt: "+at.fbu_rt_cnt+", avg: "+at.fbu_rt_total/at.fbu_rt_cnt),at.fbu_rt_start=0)),!i)return i}return I.onFBUComplete(P,{x:et.x,y:et.y,width:et.width,height:et.height,encoding:et.encoding,encodingName:q[et.encoding]}),!0},$.RAW=function(){var e,t;return 0===et.lines&&(et.lines=et.height),et.bytes=et.width*tt,z.rQwait("RAW",et.bytes)?!1:(e=et.y+(et.height-et.lines),t=Math.min(et.lines,Math.floor(z.rQlen()/(et.width*tt))),G.blitImage(et.x,e,et.width,t,z.get_rQ(),z.get_rQi()),z.rQshiftBytes(et.width*t*tt),et.lines-=t,et.lines>0?et.bytes=et.width*tt:(et.rects-=1,et.bytes=0),!0)},$.COPYRECT=function(){return et.bytes=4,z.rQwait("COPYRECT",4)?!1:(G.renderQ_push({type:"copy",old_x:z.rQshift16(),old_y:z.rQshift16(),x:et.x,y:et.y,width:et.width,height:et.height}),et.rects-=1,et.bytes=0,!0)},$.RRE=function(){var e,t,r,n,i,o;if(0===et.subrects){if(et.bytes=4+tt,z.rQwait("RRE",4+tt))return!1;et.subrects=z.rQshift32(),e=z.rQshiftBytes(tt),G.fillRect(et.x,et.y,et.width,et.height,e)}for(;et.subrects>0&&z.rQlen()>=tt+8;)e=z.rQshiftBytes(tt),t=z.rQshift16(),r=z.rQshift16(),n=z.rQshift16(),i=z.rQshift16(),G.fillRect(et.x+t,et.y+r,n,i,e),et.subrects-=1;return et.subrects>0?(o=Math.min(st,et.subrects),et.bytes=(tt+8)*o):(et.rects-=1,et.bytes=0),!0},$.HEXTILE=function(){var e,t,n,i,o,s,a,l,c,h,f,d,p,m,b,g,v,y=z.get_rQ(),E=z.get_rQi();for(0===et.tiles&&(et.tiles_x=Math.ceil(et.width/16),et.tiles_y=Math.ceil(et.height/16),et.total_tiles=et.tiles_x*et.tiles_y,et.tiles=et.total_tiles);et.tiles>0;){if(et.bytes=1,z.rQwait("HEXTILE subencoding",et.bytes))return!1;if(e=y[E],e>30)return u("Disconnected: illegal hextile subencoding "+e),!1;if(t=0,i=et.total_tiles-et.tiles,o=i%et.tiles_x,l=Math.floor(i/et.tiles_x),s=et.x+16*o,c=et.y+16*l,a=Math.min(16,et.x+et.width-s),h=Math.min(16,et.y+et.height-c),1&e)et.bytes+=a*h*tt;else if(2&e&&(et.bytes+=tt),4&e&&(et.bytes+=tt),8&e){if(et.bytes+=1,z.rQwait("hextile subrects header",et.bytes))return!1;t=y[E+et.bytes-1],et.bytes+=16&e?t*(tt+2):2*t}if(z.rQwait("hextile",et.bytes))return!1;if(et.subencoding=y[E],E+=1,0===et.subencoding)1&et.lastsubencoding?r.Debug("     Ignoring blank after RAW"):G.fillRect(s,c,a,h,et.background);else if(1&et.subencoding)G.blitImage(s,c,a,h,y,E),E+=et.bytes-1;else{if(2&et.subencoding&&(et.background=y.slice(E,E+tt),E+=tt),4&et.subencoding&&(et.foreground=y.slice(E,E+tt),E+=tt),G.startTile(s,c,a,h,et.background),8&et.subencoding)for(t=y[E],E+=1,d=0;t>d;d+=1)16&et.subencoding?(n=y.slice(E,E+tt),E+=tt):n=et.foreground,f=y[E],E+=1,p=f>>4,m=15&f,b=y[E],E+=1,g=(b>>4)+1,v=(15&b)+1,G.subTile(p,m,g,v,n);G.finishTile()}z.set_rQi(E),et.lastsubencoding=et.subencoding,et.bytes=0,et.tiles-=1}return 0===et.tiles&&(et.rects-=1),!0},T=function(e){var t=1,r=0;return r+=127&e[0],128&e[0]&&(t+=1,r+=(127&e[1])<<7,128&e[1]&&(t+=1,r+=e[2]<<14)),[t,r]};function bt(e){1===rt&&u("Tight protocol handler only implements true color mode");var t,n,i,o,s,a,l=-1,c=0,h=-1,f=z.get_rQ(),d=z.get_rQi();if(et.bytes=1,z.rQwait("TIGHT compression-control",et.bytes))return!1;var p=function(e){for(var t=0;4>t;t++)c>>t&1&&(et.zlibs[t].reset(),r.Info("Reset zlib stream "+t));var n=et.zlibs[h].uncompress(e,0);return 0!==n.status&&r.Error("Invalid data in zlib stream"),n.data},m=function(e,t,r,n,i){var o,s,a,u,l,c,h,f=[];if(2===t)for(u=Math.floor((n+7)/8),l=Math.floor(n/8),s=0;i>s;s++){for(o=0;l>o;o++)for(a=7;a>=0;a--)c=3*(s*n+8*o+7-a),h=3*(e[s*u+o]>>a&1),f[c]=r[h],f[c+1]=r[h+1],f[c+2]=r[h+2];for(a=7;a>=8-n%8;a--)c=3*(s*n+8*o+7-a),h=3*(e[s*u+o]>>a&1),f[c]=r[h],f[c+1]=r[h+1],f[c+2]=r[h+2]}else for(s=0;i>s;s++)for(o=0;n>o;o++)c=3*(s*n+o),h=3*e[s*n+o],f[c]=r[h],f[c+1]=r[h+1],f[c+2]=r[h+2];return f},b=function(){var e=f[d+2]+1,t=e*rt;if(et.bytes+=t,z.rQwait("TIGHT palette "+n,et.bytes))return!1;var r=2>=e?1:8,o=Math.floor((et.width*r+7)/8),s=!1;if(o*et.height<12?(s=!0,i=[0,o*et.height]):i=T(z.rQslice(3+t,3+t+3)),et.bytes+=i[0]+i[1],z.rQwait("TIGHT "+n,et.bytes))return!1;z.rQshiftBytes(3);var u=z.rQshiftBytes(t);z.rQshiftBytes(i[0]),a=s?z.rQshiftBytes(i[1]):p(z.rQshiftBytes(i[1]));var l=m(a,e,u,et.width,et.height);return G.renderQ_push({type:"blitRgb",data:l,x:et.x,y:et.y,width:et.width,height:et.height}),!0},g=function(){var e=!1,t=et.width*et.height*rt;return 12>t?(e=!0,i=[0,t]):i=T(z.rQslice(1,4)),et.bytes=1+i[0]+i[1],z.rQwait("TIGHT "+n,et.bytes)?!1:(z.rQshiftBytes(1+i[0]),a=e?z.rQshiftBytes(i[1]):p(z.rQshiftBytes(i[1])),G.renderQ_push({type:"blitRgb",data:a,x:et.x,y:et.y,width:et.width,height:et.height}),!0)};if(t=z.rQpeek8(),c=15&t,t>>=4,h=3&t,8===t)n="fill";else if(9===t)n="jpeg";else if(10===t)n="png";else if(4&t)n="filter";else{if(!(4>t))return u("Illegal tight compression received, ctl: "+t);n="copy"}if(e&&("filter"===n||"copy"===n))return u("filter/copy received in tightPNG mode");switch(n){case"fill":et.bytes+=rt;break;case"jpeg":et.bytes+=3;break;case"png":et.bytes+=3;break;case"filter":et.bytes+=2;break;case"copy":}if(z.rQwait("TIGHT "+n,et.bytes))return!1;switch(n){case"fill":z.rQshift8(),o=z.rQshiftBytes(rt),G.renderQ_push({type:"fill",x:et.x,y:et.y,width:et.width,height:et.height,color:[o[2],o[1],o[0]]});break;case"png":case"jpeg":if(i=T(z.rQslice(1,4)),et.bytes=1+i[0]+i[1],z.rQwait("TIGHT "+n,et.bytes))return!1;z.rQshiftBytes(1+i[0]),s=new Image,s.src="data:image/"+n+k(z.rQshiftBytes(i[1])),G.renderQ_push({type:"img",img:s,x:et.x,y:et.y}),s=null;break;case"filter":if(l=f[d+1],1!==l)throw"Unsupported tight subencoding received, filter: "+l;if(!b())return!1;break;case"copy":if(!g())return!1}return et.bytes=0,et.rects-=1,!0}return k=function(e){return";base64,"+i.encode(e)},$.TIGHT=function(){return bt(!1)},$.TIGHT_PNG=function(){return bt(!0)},$.last_rect=function(){return et.rects=0,!0},$.DesktopSize=function(){return r.Debug(">> set_desktopsize"),nt=et.width,it=et.height,I.onFBResize(P,nt,it),G.resize(nt,it),at.fbu_rt_start=(new Date).getTime(),et.bytes=0,et.rects-=1,r.Debug("<< set_desktopsize"),!0},$.Cursor=function(){var e,t,n,i,o,s;return r.Debug(">> set_cursor"),e=et.x,t=et.y,n=et.width,i=et.height,o=n*i*tt,s=Math.floor((n+7)/8)*i,et.bytes=o+s,z.rQwait("cursor encoding",et.bytes)?!1:(G.changeCursor(z.rQshiftBytes(o),z.rQshiftBytes(s),e,t,n,i),et.bytes=0,et.rects-=1,r.Debug("<< set_cursor"),!0)},$.JPEG_quality_lo=function(){r.Error("Server sent jpeg_quality pseudo-encoding")},$.compress_lo=function(){r.Error("Server sent compress level pseudo-encoding")},v=function(){var e;return e=[0],e.push8(0),e.push8(0),e.push8(0),e.push8(8*tt),e.push8(8*rt),e.push8(0),e.push8(I.true_color?1:0),e.push16(255),e.push16(255),e.push16(255),e.push8(16),e.push8(8),e.push8(0),e.push8(0),e.push8(0),e.push8(0),e},y=function(){var e,t,n=[];for(t=0;t<W.length;t+=1)"Cursor"!==W[t][0]||I.local_cursor?"TIGHT"!==W[t][0]||I.true_color?n.push(W[t][1]):r.Warn("Skipping tight, only support with true color"):r.Debug("Skipping Cursor pseudo-encoding");for(e=[2],e.push8(0),e.push16(n.length),t=0;t<n.length;t+=1)e.push32(n[t]);return e},E=function(e,t,r,n,i){"undefined"==typeof t&&(t=0),"undefined"==typeof r&&(r=0),"undefined"==typeof n&&(n=nt),"undefined"==typeof i&&(i=it);var o;return o=[3],o.push8(e),o.push16(t),o.push16(r),o.push16(n),o.push16(i),o},w=function(){var e,t,r,n=G.getCleanDirtyReset(),i=[];for(t=n.cleanBox,t.w>0&&t.h>0&&(i=i.concat(E(1,t.x,t.y,t.w,t.h))),e=0;e<n.dirtyBoxes.length;e++)r=n.dirtyBoxes[e],i=i.concat(E(0,r.x,r.y,r.w,r.h));return i},_=function(e,t){var r;return r=[4],r.push8(t),r.push16(0),r.push32(e),r},C=function(e,t){var r;return r=[5],r.push8(lt),r.push16(e),r.push16(t),r},x=function(e){var t,r,n;for(t=[6],t.push8(0),t.push8(0),t.push8(0),t.push32(e.length),n=e.length,r=0;n>r;r+=1)t.push(e.charCodeAt(r));return t},P.connect=function(e,t,r,n){return N=e,M=t,R=void 0!==r?r:"",j=void 0!==n?n:"",N&&M?void a("connect"):u("Must set host and port")},P.disconnect=function(){a("disconnect","Disconnecting")},P.sendPassword=function(e){R=e,V="Authentication",setTimeout(c,1)},P.sendCtrlAltDel=function(){if("normal"!==V||I.view_only)return!1;r.Info("Sending Ctrl-Alt-Del");var e=[];e=e.concat(_(65507,1)),e=e.concat(_(65513,1)),e=e.concat(_(65535,1)),e=e.concat(_(65535,0)),e=e.concat(_(65513,0)),e=e.concat(_(65507,0)),z.send(e)},P.xvpOp=function(e,t){return e>U?!1:(r.Info("Sending XVP operation "+t+" (version "+e+")"),z.send_string("\x00"+String.fromCharCode(e)+String.fromCharCode(t)),!0)},P.xvpShutdown=function(){return P.xvpOp(1,2)},P.xvpReboot=function(){return P.xvpOp(1,3)},P.xvpReset=function(){return P.xvpOp(1,4)},P.sendKey=function(e,t){if("normal"!==V||I.view_only)return!1;var n=[];"undefined"!=typeof t?(r.Info("Sending key code ("+(t?"down":"up")+"): "+e),n=n.concat(_(e,t?1:0))):(r.Info("Sending key code (down + up): "+e),n=n.concat(_(e,1)),n=n.concat(_(e,0))),z.send(n)},P.clipboardPasteFrom=function(e){"normal"===V&&z.send(x(e))},P.testMode=function(e,t){ut=!0,P.recv_message=z.testMode(e,t),D=function(){},P.connect=function(e,t,r){N=e,M=t,R=r,n(),a("ProtocolVersion","Starting VNC handshake")}},dt()}return{RFB:v,WebUtil:n}}(window);